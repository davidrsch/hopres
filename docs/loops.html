<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Bucles | Programación práctica con R</title>
  <meta name="description" content="Este libro le enseñará cómo programar en R, con ejemplos prácticos. Lo escribí para personas que no son programadores para proporcionar una introducción amigable al lenguaje R. Aprenderá a cargar datos, ensamblar y desensamblar objetos de datos, navegar por el sistema de entorno de R, escribir sus propias funciones y utilizar todas las herramientas de programación de R. A lo largo del libro, utilizará sus nuevas habilidades para resolver problemas prácticos de ciencia de datos." />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Bucles | Programación práctica con R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/davidrsch/hopres/cover.png" />
  <meta property="og:description" content="Este libro le enseñará cómo programar en R, con ejemplos prácticos. Lo escribí para personas que no son programadores para proporcionar una introducción amigable al lenguaje R. Aprenderá a cargar datos, ensamblar y desensamblar objetos de datos, navegar por el sistema de entorno de R, escribir sus propias funciones y utilizar todas las herramientas de programación de R. A lo largo del libro, utilizará sus nuevas habilidades para resolver problemas prácticos de ciencia de datos." />
  <meta name="github-repo" content="davidrsch/hopres" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Bucles | Programación práctica con R" />
  
  <meta name="twitter:description" content="Este libro le enseñará cómo programar en R, con ejemplos prácticos. Lo escribí para personas que no son programadores para proporcionar una introducción amigable al lenguaje R. Aprenderá a cargar datos, ensamblar y desensamblar objetos de datos, navegar por el sistema de entorno de R, escribir sus propias funciones y utilizar todas las herramientas de programación de R. A lo largo del libro, utilizará sus nuevas habilidades para resolver problemas prácticos de ciencia de datos." />
  <meta name="twitter:image" content="https://github.com/davidrsch/hopres/cover.png" />

<meta name="author" content="Garrett Grolemund" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="s3.html"/>
<link rel="next" href="speed.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="hopr.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Programación práctica con R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-la-traducción"><i class="fa fa-check"></i>Sobre la traducción</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-la-versión-original-en-inglés"><i class="fa fa-check"></i>Sobre la versión original en inglés</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html"><i class="fa fa-check"></i>Prefacio</a>
<ul>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html#convenciones-usadas-en-este-libro"><i class="fa fa-check"></i>Convenciones Usadas en Este Libro</a></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html#reconocimientos"><i class="fa fa-check"></i>Reconocimientos</a></li>
</ul></li>
<li class="part"><span><b>I Parte 1</b></span></li>
<li class="chapter" data-level="1" data-path="dice.html"><a href="dice.html"><i class="fa fa-check"></i><b>1</b> Proyecto 1: Dados Ponderados</a></li>
<li class="chapter" data-level="2" data-path="Básico.html"><a href="Básico.html"><i class="fa fa-check"></i><b>2</b> Lo Más Básico</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Básico.html"><a href="Básico.html#la-interfaz-de-usuario-de-r"><i class="fa fa-check"></i><b>2.1</b> La Interfaz de Usuario de R</a></li>
<li class="chapter" data-level="2.2" data-path="Básico.html"><a href="Básico.html#objetos"><i class="fa fa-check"></i><b>2.2</b> Objetos</a></li>
<li class="chapter" data-level="2.3" data-path="Básico.html"><a href="Básico.html#funciones"><i class="fa fa-check"></i><b>2.3</b> Funciones</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="Básico.html"><a href="Básico.html#muestra-con-reemplazo"><i class="fa fa-check"></i><b>2.3.1</b> Muestra con reemplazo</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Básico.html"><a href="Básico.html#Escribir-funciones"><i class="fa fa-check"></i><b>2.4</b> Escribiendo Sus Propias Funciones</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="Básico.html"><a href="Básico.html#el-constructor-de-funciones"><i class="fa fa-check"></i><b>2.4.1</b> El Constructor de Funciones</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="Básico.html"><a href="Básico.html#argumentos"><i class="fa fa-check"></i><b>2.5</b> Argumentos</a></li>
<li class="chapter" data-level="2.6" data-path="Básico.html"><a href="Básico.html#scripts"><i class="fa fa-check"></i><b>2.6</b> Scripts</a></li>
<li class="chapter" data-level="2.7" data-path="Básico.html"><a href="Básico.html#resumen"><i class="fa fa-check"></i><b>2.7</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>3</b> Paquetes y páginas de ayuda</a>
<ul>
<li class="chapter" data-level="3.1" data-path="packages.html"><a href="packages.html#paquetes"><i class="fa fa-check"></i><b>3.1</b> Paquetes</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="packages.html"><a href="packages.html#install.packages"><i class="fa fa-check"></i><b>3.1.1</b> install.packages</a></li>
<li class="chapter" data-level="3.1.2" data-path="packages.html"><a href="packages.html#library"><i class="fa fa-check"></i><b>3.1.2</b> library</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="packages.html"><a href="packages.html#obteniendo-ayuda-con-las-páginas-de-ayuda"><i class="fa fa-check"></i><b>3.2</b> Obteniendo Ayuda con las Páginas de Ayuda</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="packages.html"><a href="packages.html#partes-de-una-página-de-ayuda"><i class="fa fa-check"></i><b>3.2.1</b> Partes de una Página de Ayuda</a></li>
<li class="chapter" data-level="3.2.2" data-path="packages.html"><a href="packages.html#obteniendo-más-ayuda"><i class="fa fa-check"></i><b>3.2.2</b> Obteniendo Más Ayuda</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="packages.html"><a href="packages.html#resumen-1"><i class="fa fa-check"></i><b>3.3</b> Resumen</a></li>
<li class="chapter" data-level="3.4" data-path="packages.html"><a href="packages.html#resumen-del-proyecto-1"><i class="fa fa-check"></i><b>3.4</b> Resumen del Proyecto 1</a></li>
</ul></li>
<li class="part"><span><b>II Parte 2</b></span></li>
<li class="chapter" data-level="4" data-path="cards.html"><a href="cards.html"><i class="fa fa-check"></i><b>4</b> Proyecto 2: Baraja de Cartas</a></li>
<li class="chapter" data-level="5" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>5</b> Objectos de R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="objects.html"><a href="objects.html#vectores-atómicos"><i class="fa fa-check"></i><b>5.1</b> Vectores Atómicos</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="objects.html"><a href="objects.html#dobles"><i class="fa fa-check"></i><b>5.1.1</b> Dobles</a></li>
<li class="chapter" data-level="5.1.2" data-path="objects.html"><a href="objects.html#enteros"><i class="fa fa-check"></i><b>5.1.2</b> Enteros</a></li>
<li class="chapter" data-level="5.1.3" data-path="objects.html"><a href="objects.html#caracteres"><i class="fa fa-check"></i><b>5.1.3</b> Caracteres</a></li>
<li class="chapter" data-level="5.1.4" data-path="objects.html"><a href="objects.html#lógicos"><i class="fa fa-check"></i><b>5.1.4</b> Lógicos</a></li>
<li class="chapter" data-level="5.1.5" data-path="objects.html"><a href="objects.html#complejo-y-sin-procesar"><i class="fa fa-check"></i><b>5.1.5</b> Complejo y Sin Procesar</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="objects.html"><a href="objects.html#attributes"><i class="fa fa-check"></i><b>5.2</b> Atributos</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="objects.html"><a href="objects.html#names"><i class="fa fa-check"></i><b>5.2.1</b> Nombres</a></li>
<li class="chapter" data-level="5.2.2" data-path="objects.html"><a href="objects.html#dimensiones"><i class="fa fa-check"></i><b>5.2.2</b> Dimensiones</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="objects.html"><a href="objects.html#matrices"><i class="fa fa-check"></i><b>5.3</b> Matrices</a></li>
<li class="chapter" data-level="5.4" data-path="objects.html"><a href="objects.html#arreglos"><i class="fa fa-check"></i><b>5.4</b> Arreglos</a></li>
<li class="chapter" data-level="5.5" data-path="objects.html"><a href="objects.html#clases"><i class="fa fa-check"></i><b>5.5</b> Clases</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="objects.html"><a href="objects.html#fechas-y-horarios"><i class="fa fa-check"></i><b>5.5.1</b> Fechas y Horarios</a></li>
<li class="chapter" data-level="5.5.2" data-path="objects.html"><a href="objects.html#factores"><i class="fa fa-check"></i><b>5.5.2</b> Factores</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="objects.html"><a href="objects.html#coerción"><i class="fa fa-check"></i><b>5.6</b> Coerción</a></li>
<li class="chapter" data-level="5.7" data-path="objects.html"><a href="objects.html#listas"><i class="fa fa-check"></i><b>5.7</b> Listas</a></li>
<li class="chapter" data-level="5.8" data-path="objects.html"><a href="objects.html#data-frames"><i class="fa fa-check"></i><b>5.8</b> Data Frames</a></li>
<li class="chapter" data-level="5.9" data-path="objects.html"><a href="objects.html#loading"><i class="fa fa-check"></i><b>5.9</b> Cargar Datos</a></li>
<li class="chapter" data-level="5.10" data-path="objects.html"><a href="objects.html#guardar-datos"><i class="fa fa-check"></i><b>5.10</b> Guardar Datos</a></li>
<li class="chapter" data-level="5.11" data-path="objects.html"><a href="objects.html#resumen-2"><i class="fa fa-check"></i><b>5.11</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="notation.html"><a href="notation.html"><i class="fa fa-check"></i><b>6</b> Notación de R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="notation.html"><a href="notation.html#selección-de-valores"><i class="fa fa-check"></i><b>6.1</b> Selección de Valores</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="notation.html"><a href="notation.html#números-enteros-positivos"><i class="fa fa-check"></i><b>6.1.1</b> Números Enteros Positivos</a></li>
<li class="chapter" data-level="6.1.2" data-path="notation.html"><a href="notation.html#números-enteros-negativos"><i class="fa fa-check"></i><b>6.1.2</b> Números Enteros Negativos</a></li>
<li class="chapter" data-level="6.1.3" data-path="notation.html"><a href="notation.html#cero"><i class="fa fa-check"></i><b>6.1.3</b> Cero</a></li>
<li class="chapter" data-level="6.1.4" data-path="notation.html"><a href="notation.html#espacios-en-blanco"><i class="fa fa-check"></i><b>6.1.4</b> Espacios en Blanco</a></li>
<li class="chapter" data-level="6.1.5" data-path="notation.html"><a href="notation.html#logic"><i class="fa fa-check"></i><b>6.1.5</b> Valores Lógicos</a></li>
<li class="chapter" data-level="6.1.6" data-path="notation.html"><a href="notation.html#nombres"><i class="fa fa-check"></i><b>6.1.6</b> Nombres</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="notation.html"><a href="notation.html#repartir-una-carta"><i class="fa fa-check"></i><b>6.2</b> Repartir una Carta</a></li>
<li class="chapter" data-level="6.3" data-path="notation.html"><a href="notation.html#barajar-el-mazo"><i class="fa fa-check"></i><b>6.3</b> Barajar el Mazo</a></li>
<li class="chapter" data-level="6.4" data-path="notation.html"><a href="notation.html#signos-de-dólar-y-corchetes-dobles"><i class="fa fa-check"></i><b>6.4</b> Signos de Dólar y Corchetes Dobles</a></li>
<li class="chapter" data-level="6.5" data-path="notation.html"><a href="notation.html#resumen-3"><i class="fa fa-check"></i><b>6.5</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modify.html"><a href="modify.html"><i class="fa fa-check"></i><b>7</b> Modificación de Valores</a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="modify.html"><a href="modify.html#cambio-de-valores-en-el-lugar"><i class="fa fa-check"></i><b>7.0.1</b> Cambio de Valores en el Lugar</a></li>
<li class="chapter" data-level="7.0.2" data-path="modify.html"><a href="modify.html#subconjunto-lógico"><i class="fa fa-check"></i><b>7.0.2</b> Subconjunto Lógico</a></li>
<li class="chapter" data-level="7.0.3" data-path="modify.html"><a href="modify.html#missing"><i class="fa fa-check"></i><b>7.0.3</b> Información Faltante</a></li>
<li class="chapter" data-level="7.0.4" data-path="modify.html"><a href="modify.html#resumen-4"><i class="fa fa-check"></i><b>7.0.4</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="environment.html"><a href="environment.html"><i class="fa fa-check"></i><b>8</b> Entornos</a>
<ul>
<li class="chapter" data-level="8.1" data-path="environment.html"><a href="environment.html#entornos"><i class="fa fa-check"></i><b>8.1</b> Entornos</a></li>
<li class="chapter" data-level="8.2" data-path="environment.html"><a href="environment.html#trabajar-con-entornos"><i class="fa fa-check"></i><b>8.2</b> Trabajar con Entornos</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="environment.html"><a href="environment.html#el-entorno-activo"><i class="fa fa-check"></i><b>8.2.1</b> El Entorno Activo</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="environment.html"><a href="environment.html#reglas-de-alcance"><i class="fa fa-check"></i><b>8.3</b> Reglas de Alcance</a></li>
<li class="chapter" data-level="8.4" data-path="environment.html"><a href="environment.html#asignación"><i class="fa fa-check"></i><b>8.4</b> Asignación</a></li>
<li class="chapter" data-level="8.5" data-path="environment.html"><a href="environment.html#evaluación"><i class="fa fa-check"></i><b>8.5</b> Evaluación</a></li>
<li class="chapter" data-level="8.6" data-path="environment.html"><a href="environment.html#cierres"><i class="fa fa-check"></i><b>8.6</b> Cierres</a></li>
<li class="chapter" data-level="8.7" data-path="environment.html"><a href="environment.html#resumen-5"><i class="fa fa-check"></i><b>8.7</b> Resumen</a></li>
<li class="chapter" data-level="8.8" data-path="environment.html"><a href="environment.html#resumen-del-proyecto-2"><i class="fa fa-check"></i><b>8.8</b> Resumen del Proyecto 2</a></li>
</ul></li>
<li class="part"><span><b>III Parte 3</b></span></li>
<li class="chapter" data-level="9" data-path="slots.html"><a href="slots.html"><i class="fa fa-check"></i><b>9</b> Proyecto 3: Máquina Tragamonedas</a></li>
<li class="chapter" data-level="10" data-path="programs.html"><a href="programs.html"><i class="fa fa-check"></i><b>10</b> Programas</a>
<ul>
<li class="chapter" data-level="10.1" data-path="programs.html"><a href="programs.html#estrategia"><i class="fa fa-check"></i><b>10.1</b> Estrategia</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="programs.html"><a href="programs.html#pasos-secuenciales"><i class="fa fa-check"></i><b>10.1.1</b> Pasos Secuenciales</a></li>
<li class="chapter" data-level="10.1.2" data-path="programs.html"><a href="programs.html#casos-paralelos"><i class="fa fa-check"></i><b>10.1.2</b> Casos Paralelos</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="programs.html"><a href="programs.html#declaraciones-if"><i class="fa fa-check"></i><b>10.2</b> Declaraciones if</a></li>
<li class="chapter" data-level="10.3" data-path="programs.html"><a href="programs.html#declaraciones-else"><i class="fa fa-check"></i><b>10.3</b> Declaraciones else</a></li>
<li class="chapter" data-level="10.4" data-path="programs.html"><a href="programs.html#tablas-de-búsqueda"><i class="fa fa-check"></i><b>10.4</b> Tablas de Búsqueda</a></li>
<li class="chapter" data-level="10.5" data-path="programs.html"><a href="programs.html#comentarios-de-código"><i class="fa fa-check"></i><b>10.5</b> Comentarios de Código</a></li>
<li class="chapter" data-level="10.6" data-path="programs.html"><a href="programs.html#resumen-6"><i class="fa fa-check"></i><b>10.6</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="s3.html"><a href="s3.html"><i class="fa fa-check"></i><b>11</b> S3</a>
<ul>
<li class="chapter" data-level="11.1" data-path="s3.html"><a href="s3.html#el-sistema-s3"><i class="fa fa-check"></i><b>11.1</b> El Sistema S3</a></li>
<li class="chapter" data-level="11.2" data-path="s3.html"><a href="s3.html#atributos"><i class="fa fa-check"></i><b>11.2</b> Atributos</a></li>
<li class="chapter" data-level="11.3" data-path="s3.html"><a href="s3.html#funciones-genéricas"><i class="fa fa-check"></i><b>11.3</b> Funciones Genéricas</a></li>
<li class="chapter" data-level="11.4" data-path="s3.html"><a href="s3.html#métodos"><i class="fa fa-check"></i><b>11.4</b> Métodos</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="s3.html"><a href="s3.html#selección-de-método"><i class="fa fa-check"></i><b>11.4.1</b> Selección de Método</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="s3.html"><a href="s3.html#clases-1"><i class="fa fa-check"></i><b>11.5</b> Clases</a></li>
<li class="chapter" data-level="11.6" data-path="s3.html"><a href="s3.html#s3-y-depuración"><i class="fa fa-check"></i><b>11.6</b> S3 y Depuración</a></li>
<li class="chapter" data-level="11.7" data-path="s3.html"><a href="s3.html#s4-y-r5"><i class="fa fa-check"></i><b>11.7</b> S4 y R5</a></li>
<li class="chapter" data-level="11.8" data-path="s3.html"><a href="s3.html#resumen-7"><i class="fa fa-check"></i><b>11.8</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>12</b> Bucles</a>
<ul>
<li class="chapter" data-level="12.1" data-path="loops.html"><a href="loops.html#expected-values"><i class="fa fa-check"></i><b>12.1</b> Expected Values</a></li>
<li class="chapter" data-level="12.2" data-path="loops.html"><a href="loops.html#expand.grid"><i class="fa fa-check"></i><b>12.2</b> expand.grid</a></li>
<li class="chapter" data-level="12.3" data-path="loops.html"><a href="loops.html#for-loops"><i class="fa fa-check"></i><b>12.3</b> for Loops</a></li>
<li class="chapter" data-level="12.4" data-path="loops.html"><a href="loops.html#while-loops"><i class="fa fa-check"></i><b>12.4</b> while Loops</a></li>
<li class="chapter" data-level="12.5" data-path="loops.html"><a href="loops.html#repeat-loops"><i class="fa fa-check"></i><b>12.5</b> repeat Loops</a></li>
<li class="chapter" data-level="12.6" data-path="loops.html"><a href="loops.html#summary"><i class="fa fa-check"></i><b>12.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="speed.html"><a href="speed.html"><i class="fa fa-check"></i><b>13</b> Speed</a>
<ul>
<li class="chapter" data-level="13.1" data-path="speed.html"><a href="speed.html#vectorized-code"><i class="fa fa-check"></i><b>13.1</b> Vectorized Code</a></li>
<li class="chapter" data-level="13.2" data-path="speed.html"><a href="speed.html#how-to-write-vectorized-code"><i class="fa fa-check"></i><b>13.2</b> How to Write Vectorized Code</a></li>
<li class="chapter" data-level="13.3" data-path="speed.html"><a href="speed.html#how-to-write-fast-for-loops-in-r"><i class="fa fa-check"></i><b>13.3</b> How to Write Fast for Loops in R</a></li>
<li class="chapter" data-level="13.4" data-path="speed.html"><a href="speed.html#vectorized-code-in-practice"><i class="fa fa-check"></i><b>13.4</b> Vectorized Code in Practice</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="speed.html"><a href="speed.html#loops-versus-vectorized-code"><i class="fa fa-check"></i><b>13.4.1</b> Loops Versus Vectorized Code</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="speed.html"><a href="speed.html#summary-1"><i class="fa fa-check"></i><b>13.5</b> Summary</a></li>
<li class="chapter" data-level="13.6" data-path="speed.html"><a href="speed.html#project-3-wrap-up"><i class="fa fa-check"></i><b>13.6</b> Project 3 Wrap-up</a></li>
</ul></li>
<li class="appendix"><span><b>Apéndice</b></span></li>
<li class="chapter" data-level="A" data-path="starting.html"><a href="starting.html"><i class="fa fa-check"></i><b>A</b> Instalación de R y RStudio</a>
<ul>
<li class="chapter" data-level="A.1" data-path="starting.html"><a href="starting.html#cómo-descargar-e-instalar-r"><i class="fa fa-check"></i><b>A.1</b> Cómo descargar e instalar R</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="starting.html"><a href="starting.html#windows"><i class="fa fa-check"></i><b>A.1.1</b> Windows</a></li>
<li class="chapter" data-level="A.1.2" data-path="starting.html"><a href="starting.html#mac"><i class="fa fa-check"></i><b>A.1.2</b> Mac</a></li>
<li class="chapter" data-level="A.1.3" data-path="starting.html"><a href="starting.html#linux"><i class="fa fa-check"></i><b>A.1.3</b> Linux</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="starting.html"><a href="starting.html#usando-r"><i class="fa fa-check"></i><b>A.2</b> Usando R</a></li>
<li class="chapter" data-level="A.3" data-path="starting.html"><a href="starting.html#rstudio"><i class="fa fa-check"></i><b>A.3</b> RStudio</a></li>
<li class="chapter" data-level="A.4" data-path="starting.html"><a href="starting.html#abriendo-r"><i class="fa fa-check"></i><b>A.4</b> Abriendo R</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="packages2.html"><a href="packages2.html"><i class="fa fa-check"></i><b>B</b> Paquetes de R</a>
<ul>
<li class="chapter" data-level="B.1" data-path="packages2.html"><a href="packages2.html#instalando-paquetes"><i class="fa fa-check"></i><b>B.1</b> Instalando Paquetes</a></li>
<li class="chapter" data-level="B.2" data-path="packages2.html"><a href="packages2.html#cargando-paquetes"><i class="fa fa-check"></i><b>B.2</b> Cargando Paquetes</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="updating.html"><a href="updating.html"><i class="fa fa-check"></i><b>C</b> Updating R and Its Packages</a>
<ul>
<li class="chapter" data-level="C.1" data-path="updating.html"><a href="updating.html#r-packages"><i class="fa fa-check"></i><b>C.1</b> R Packages</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="dataio.html"><a href="dataio.html"><i class="fa fa-check"></i><b>D</b> Cargar y Guardar Datos en R</a>
<ul>
<li class="chapter" data-level="D.1" data-path="dataio.html"><a href="dataio.html#conjuntos-de-datos-en-r-base"><i class="fa fa-check"></i><b>D.1</b> Conjuntos de Datos en R Base</a></li>
<li class="chapter" data-level="D.2" data-path="dataio.html"><a href="dataio.html#directorio-de-trabajo"><i class="fa fa-check"></i><b>D.2</b> Directorio de Trabajo</a></li>
<li class="chapter" data-level="D.3" data-path="dataio.html"><a href="dataio.html#archivos-de-texto-sin-formato"><i class="fa fa-check"></i><b>D.3</b> Archivos de Texto Sin Formato</a>
<ul>
<li class="chapter" data-level="D.3.1" data-path="dataio.html"><a href="dataio.html#read.table"><i class="fa fa-check"></i><b>D.3.1</b> read.table</a></li>
<li class="chapter" data-level="D.3.2" data-path="dataio.html"><a href="dataio.html#la-familia-read"><i class="fa fa-check"></i><b>D.3.2</b> La Familia read</a></li>
<li class="chapter" data-level="D.3.3" data-path="dataio.html"><a href="dataio.html#read.fwf"><i class="fa fa-check"></i><b>D.3.3</b> read.fwf</a></li>
<li class="chapter" data-level="D.3.4" data-path="dataio.html"><a href="dataio.html#links-html"><i class="fa fa-check"></i><b>D.3.4</b> Links HTML</a></li>
<li class="chapter" data-level="D.3.5" data-path="dataio.html"><a href="dataio.html#guardar-archivos-de-texto-sin-formato"><i class="fa fa-check"></i><b>D.3.5</b> Guardar Archivos de Texto Sin Formato</a></li>
<li class="chapter" data-level="D.3.6" data-path="dataio.html"><a href="dataio.html#comprimiendo-archivos"><i class="fa fa-check"></i><b>D.3.6</b> Comprimiendo Archivos</a></li>
</ul></li>
<li class="chapter" data-level="D.4" data-path="dataio.html"><a href="dataio.html#archivos-de-r"><i class="fa fa-check"></i><b>D.4</b> Archivos de R</a>
<ul>
<li class="chapter" data-level="D.4.1" data-path="dataio.html"><a href="dataio.html#guardar-archivos-de-r"><i class="fa fa-check"></i><b>D.4.1</b> Guardar archivos de R</a></li>
</ul></li>
<li class="chapter" data-level="D.5" data-path="dataio.html"><a href="dataio.html#hojas-de-cálculo-de-excel"><i class="fa fa-check"></i><b>D.5</b> Hojas de Cálculo de Excel</a>
<ul>
<li class="chapter" data-level="D.5.1" data-path="dataio.html"><a href="dataio.html#exportar-desde-excel"><i class="fa fa-check"></i><b>D.5.1</b> Exportar desde Excel</a></li>
<li class="chapter" data-level="D.5.2" data-path="dataio.html"><a href="dataio.html#copiar-y-pegar"><i class="fa fa-check"></i><b>D.5.2</b> Copiar y pegar</a></li>
<li class="chapter" data-level="D.5.3" data-path="dataio.html"><a href="dataio.html#xlconnect"><i class="fa fa-check"></i><b>D.5.3</b> XLConnect</a></li>
<li class="chapter" data-level="D.5.4" data-path="dataio.html"><a href="dataio.html#lectura-de-hojas-de-cálculo"><i class="fa fa-check"></i><b>D.5.4</b> Lectura de Hojas de Cálculo</a></li>
<li class="chapter" data-level="D.5.5" data-path="dataio.html"><a href="dataio.html#escribir-hojas-de-cálculo"><i class="fa fa-check"></i><b>D.5.5</b> Escribir Hojas de Cálculo</a></li>
</ul></li>
<li class="chapter" data-level="D.6" data-path="dataio.html"><a href="dataio.html#cargar-archivos-desde-otros-programas"><i class="fa fa-check"></i><b>D.6</b> Cargar Archivos desde Otros Programas</a>
<ul>
<li class="chapter" data-level="D.6.1" data-path="dataio.html"><a href="dataio.html#conexión-a-bases-de-datos"><i class="fa fa-check"></i><b>D.6.1</b> Conexión a bases de datos</a></li>
</ul></li>
<li class="chapter" data-level="D.7" data-path="dataio.html"><a href="dataio.html#actualización"><i class="fa fa-check"></i><b>D.7</b> Actualización</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="debug.html"><a href="debug.html"><i class="fa fa-check"></i><b>E</b> Depuración de Código de R</a>
<ul>
<li class="chapter" data-level="E.1" data-path="debug.html"><a href="debug.html#traceback"><i class="fa fa-check"></i><b>E.1</b> traceback</a></li>
<li class="chapter" data-level="E.2" data-path="debug.html"><a href="debug.html#browser"><i class="fa fa-check"></i><b>E.2</b> browser</a></li>
<li class="chapter" data-level="E.3" data-path="debug.html"><a href="debug.html#puntos-de-ruptura"><i class="fa fa-check"></i><b>E.3</b> Puntos de Ruptura</a></li>
<li class="chapter" data-level="E.4" data-path="debug.html"><a href="debug.html#debug-1"><i class="fa fa-check"></i><b>E.4</b> debug</a></li>
<li class="chapter" data-level="E.5" data-path="debug.html"><a href="debug.html#trace"><i class="fa fa-check"></i><b>E.5</b> trace</a></li>
<li class="chapter" data-level="E.6" data-path="debug.html"><a href="debug.html#recover"><i class="fa fa-check"></i><b>E.6</b> recover</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Programación práctica con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="loops" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">12</span> Bucles<a href="loops.html#loops" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Loops are R’s method for repeating a task, which makes them a useful tool for programming simulations. This chapter will teach you how to use R’s loop tools.</p>
<p>Let’s use the <code>score</code> function to solve a real-world problem.</p>
<p>Your slot machine is modeled after real machines that were accused of fraud. The machines appeared to pay out 40 cents on the dollar, but the manufacturer claimed that they paid out 92 cents on the dollar. You can calculate the exact payout rate of your machine with the <code>score</code> program. The payout rate will be the expected value of the slot machine’s prize.</p>
<div id="expected-values" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Expected Values<a href="loops.html#expected-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The expected value of a random event is a type of weighted average; it is the sum of each possible outcome of the event, weighted by the probability that each outcome occurs:</p>
<p><span class="math display">\[
E(x) = \sum_{i = 1}^{n}\left( x_{i} \cdot P(x_{i}) \right)
\]</span></p>
<p>You can think of the expected value as the average prize that you would observe if you played the slot machine an infinite number of times. Let’s use the formula to calculate some simple expected values. Then we will apply the formula to your slot machine.</p>
<p>Do you remember the <code>die</code> you created in [Project 1: Weighted Dice]?</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="loops.html#cb344-1" aria-hidden="true" tabindex="-1"></a>die <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span></code></pre></div>
<p>Each time you roll the die, it returns a value selected at random (one through six). You can find the expected value of rolling the die with the formula:</p>
<p><span class="math display">\[
E(\text{die}) = \sum_{i = 1}^{n}\left( \text{die}_{i} \cdot P(\text{die}_{i}) \right)
\]</span></p>
<p>The <span class="math inline">\(\text{die}_{i}\)</span>s are the possible outcomes of rolling the die: 1, 2, 3, 4, 5, and 6; and the <span class="math inline">\(P(\text{die}_{i})\)</span>’s are the probabilities associated with each of the outcomes. If your die is fair, each outcome will occur with the same probability: 1/6. So our equation simplifies to:</p>
<p><span class="math display">\[
\begin{array}{rl}
E(\text{die}) &amp; = \sum_{i = 1}^{n}\left( \text{die}_{i} \cdot P(\text{die}_{i}) \right)\\
&amp; = 1 \cdot \frac{1}{6} +  2 \cdot \frac{1}{6} + 3 \cdot \frac{1}{6} + 4 \cdot \frac{1}{6} + 5 \cdot \frac{1}{6} + 6 \cdot \frac{1}{6}\\
&amp; = 3.5\\
\end{array}
\]</span></p>
<p>Hence, the expected value of rolling a fair die is 3.5. You may notice that this is also the average value of the die. The expected value will equal the average if every outcome has the same chance of occurring.</p>
<p>But what if each outcome has a different chance of occurring? For example, we weighted our dice in [Packages and Help Pages] so that each die rolled 1, 2, 3, 4, and 5 with probability 1/8 and 6 with probability 3/8. You can use the same formula to calculate the expected value in these conditions:</p>
<p><span class="math display">\[
\begin{array}{rl}
  E(die) &amp; = 1 \cdot \frac{1}{8} +  2 \cdot \frac{1}{8} + 3 \cdot \frac{1}{8} + 4 \cdot \frac{1}{8} + 5 \cdot \frac{1}{8} + 6 \cdot \frac{3}{8}\\
  &amp; = 4.125\\
  \end{array}
\]</span></p>
<p>Hence, the expected value of a loaded die does not equal the average value of its outcomes. If you rolled a loaded die an infinite number of times, the average outcome would be 4.125, which is higher than what you would expect from a fair die.</p>
<p>Notice that we did the same three things to calculate both of these expected values. We have:</p>
<ul>
<li>Listed out all of the possible outcomes</li>
<li>Determined the <em>value</em> of each outcome (here just the value of the die)</li>
<li>Calculated the probability that each outcome occurred</li>
</ul>
<p>The expected value was then just the sum of the values in step 2 multiplied by the probabilities in step 3.</p>
<p>You can use these steps to calculate more sophisticated expected values. For example, you could calculate the expected value of rolling a pair of weighted dice. Let’s do this step by step.</p>
<p>First, list out all of the possible outcomes. A total of 36 different outcomes can appear when you roll two dice. For example, you might roll (1, 1), which notates one on the first die and one on the second die. Or, you may roll (1, 2), one on the first die and two on the second. And so on. Listing out these combinations can be tedious, but R has a function that can help.</p>
</div>
<div id="expand.grid" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> expand.grid<a href="loops.html#expand.grid" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>expand.grid</code> function in R provides a quick way to write out every combination of the elements in <em>n</em> vectors. For example, you can list every combination of two dice. To do so, run <code>expand.grid</code> on two copies of <code>die</code>:</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="loops.html#cb345-1" aria-hidden="true" tabindex="-1"></a>rolls <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(die, die)</span></code></pre></div>
<p><code>expand.grid</code> will return a data frame that contains every way to pair an element from the first <code>die</code> vector with an element from the second <code>die</code> vector. This will capture all 36 possible combinations of values:</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="loops.html#cb346-1" aria-hidden="true" tabindex="-1"></a>rolls</span>
<span id="cb346-2"><a href="loops.html#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="do">##    Var1 Var2</span></span>
<span id="cb346-3"><a href="loops.html#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1    1</span></span>
<span id="cb346-4"><a href="loops.html#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     2    1</span></span>
<span id="cb346-5"><a href="loops.html#cb346-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     3    1</span></span>
<span id="cb346-6"><a href="loops.html#cb346-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ...</span></span>
<span id="cb346-7"><a href="loops.html#cb346-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 34    4    6</span></span>
<span id="cb346-8"><a href="loops.html#cb346-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 35    5    6</span></span>
<span id="cb346-9"><a href="loops.html#cb346-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 36    6    6</span></span></code></pre></div>
<p>You can use <code>expand.grid</code> with more than two vectors if you like. For example, you could list every combination of rolling three dice with <code>expand.grid(die, die, die)</code> and every combination of rolling four dice with <code>expand.grid(die, die, die, die)</code>, and so on. <code>expand.grid</code> will always return a data frame that contains each possible combination of <em>n</em> elements from the <em>n</em> vectors. Each combination will contain exactly one element from each vector.</p>
<p>You can determine the value of each roll once you’ve made your list of outcomes. This will be the sum of the two dice, which you can calculate using R’s element-wise execution:</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="loops.html#cb347-1" aria-hidden="true" tabindex="-1"></a>rolls<span class="sc">$</span>value <span class="ot">&lt;-</span> rolls<span class="sc">$</span>Var1 <span class="sc">+</span> rolls<span class="sc">$</span>Var2</span>
<span id="cb347-2"><a href="loops.html#cb347-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rolls, <span class="dv">3</span>)</span>
<span id="cb347-3"><a href="loops.html#cb347-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Var1 Var2 value</span></span>
<span id="cb347-4"><a href="loops.html#cb347-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    1    1     2</span></span>
<span id="cb347-5"><a href="loops.html#cb347-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    2    1     3</span></span>
<span id="cb347-6"><a href="loops.html#cb347-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    3    1     4</span></span></code></pre></div>
<p>R will match up the elements in each vector before adding them together. As a result, each element of <code>value</code> will refer to the elements of <code>Var1</code> and <code>Var2</code> that appear in the same row.</p>
<p>Next, you must determine the probability that each combination appears. You can calculate this with a basic rule of probability:</p>
<p><em>The probability that</em> n <em>independent, random events all occur is equal to the product of the probabilities that each random event occurs</em>.</p>
<p>Or more succinctly:</p>
<p><span class="math display">\[
P(A \&amp; B \&amp; C \&amp; ...) = P(A) \cdot P(B) \cdot P(C) \cdot ...
\]</span></p>
<p>So the probability that we roll a (1, 1) will be equal to the probability that we roll a one on the first die, 1/8, times the probability that we roll a one on the second die, 1/8:</p>
<p><span class="math display">\[
\begin{array}{rl}
P(1 \&amp; 1) &amp; = P(1) \cdot P(1) \\
&amp; = \frac{1}{8} \cdot \frac{1}{8}\\
&amp; = \frac{1}{64}
\end{array}
\]</span></p>
<p>And the probability that we roll a (1, 2) will be:</p>
<p><span class="math display">\[
\begin{array}{rl}
P(1 \&amp; 2) &amp; = P(1) \cdot P(2) \\
&amp; = \frac{1}{8} \cdot \frac{1}{8}\\
&amp; = \frac{1}{64}
\end{array}
\]</span></p>
<p>And so on.</p>
<p>Let me suggest a three-step process for calculating these probabilities in R. First, we can look up the probabilities of rolling the values in <code>Var1</code>. We’ll do this with the lookup table that follows:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="loops.html#cb348-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="st">&quot;4&quot;</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="st">&quot;5&quot;</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="st">&quot;6&quot;</span> <span class="ot">=</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">8</span>)</span>
<span id="cb348-2"><a href="loops.html#cb348-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-3"><a href="loops.html#cb348-3" aria-hidden="true" tabindex="-1"></a>prob</span>
<span id="cb348-4"><a href="loops.html#cb348-4" aria-hidden="true" tabindex="-1"></a><span class="do">##     1     2     3     4     5     6 </span></span>
<span id="cb348-5"><a href="loops.html#cb348-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.125 0.125 0.125 0.125 0.125 0.375 </span></span></code></pre></div>
<p>If you subset this table by <code>rolls$Var1</code>, you will get a vector of probabilities perfectly keyed to the values of <code>Var1</code>:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="loops.html#cb349-1" aria-hidden="true" tabindex="-1"></a>rolls<span class="sc">$</span>Var1</span>
<span id="cb349-2"><a href="loops.html#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 2 3 4 5 6 1 2 3 4 5 6 1 2 3 4 5 6 1 2 3 4 5 6 1 2 3 4 5 6 1 2 3 4 5 6</span></span>
<span id="cb349-3"><a href="loops.html#cb349-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-4"><a href="loops.html#cb349-4" aria-hidden="true" tabindex="-1"></a>prob[rolls<span class="sc">$</span>Var1]</span>
<span id="cb349-5"><a href="loops.html#cb349-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     1     2     3     4     5     6     1     2     3     4     5     6 </span></span>
<span id="cb349-6"><a href="loops.html#cb349-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.125 0.125 0.125 0.125 0.125 0.375 0.125 0.125 0.125 0.125 0.125 0.375 </span></span>
<span id="cb349-7"><a href="loops.html#cb349-7" aria-hidden="true" tabindex="-1"></a><span class="do">##     1     2     3     4     5     6     1     2     3     4     5     6 </span></span>
<span id="cb349-8"><a href="loops.html#cb349-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.125 0.125 0.125 0.125 0.125 0.375 0.125 0.125 0.125 0.125 0.125 0.375 </span></span>
<span id="cb349-9"><a href="loops.html#cb349-9" aria-hidden="true" tabindex="-1"></a><span class="do">##     1     2     3     4     5     6     1     2     3     4     5     6 </span></span>
<span id="cb349-10"><a href="loops.html#cb349-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.125 0.125 0.125 0.125 0.125 0.375 0.125 0.125 0.125 0.125 0.125 0.375 </span></span>
<span id="cb349-11"><a href="loops.html#cb349-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-12"><a href="loops.html#cb349-12" aria-hidden="true" tabindex="-1"></a>rolls<span class="sc">$</span>prob1 <span class="ot">&lt;-</span> prob[rolls<span class="sc">$</span>Var1]</span>
<span id="cb349-13"><a href="loops.html#cb349-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rolls, <span class="dv">3</span>)</span>
<span id="cb349-14"><a href="loops.html#cb349-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Var1 Var2 value prob1</span></span>
<span id="cb349-15"><a href="loops.html#cb349-15" aria-hidden="true" tabindex="-1"></a><span class="do">##    1    1     2 0.125</span></span>
<span id="cb349-16"><a href="loops.html#cb349-16" aria-hidden="true" tabindex="-1"></a><span class="do">##    2    1     3 0.125</span></span>
<span id="cb349-17"><a href="loops.html#cb349-17" aria-hidden="true" tabindex="-1"></a><span class="do">##    3    1     4 0.125</span></span></code></pre></div>
<p>Second, we can look up the probabilities of rolling the values in <code>Var2</code>:</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="loops.html#cb350-1" aria-hidden="true" tabindex="-1"></a>rolls<span class="sc">$</span>prob2 <span class="ot">&lt;-</span> prob[rolls<span class="sc">$</span>Var2]</span>
<span id="cb350-2"><a href="loops.html#cb350-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-3"><a href="loops.html#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rolls, <span class="dv">3</span>)</span>
<span id="cb350-4"><a href="loops.html#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Var1 Var2 value prob1 prob2</span></span>
<span id="cb350-5"><a href="loops.html#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    1    1     2 0.125 0.125</span></span>
<span id="cb350-6"><a href="loops.html#cb350-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    2    1     3 0.125 0.125</span></span>
<span id="cb350-7"><a href="loops.html#cb350-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    3    1     4 0.125 0.125</span></span></code></pre></div>
<p>Third, we can calculate the probability of rolling each combination by multiplying <code>prob1</code> by <code>prob2</code>:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="loops.html#cb351-1" aria-hidden="true" tabindex="-1"></a>rolls<span class="sc">$</span>prob <span class="ot">&lt;-</span> rolls<span class="sc">$</span>prob1 <span class="sc">*</span> rolls<span class="sc">$</span>prob2</span>
<span id="cb351-2"><a href="loops.html#cb351-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-3"><a href="loops.html#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rolls, <span class="dv">3</span>)</span>
<span id="cb351-4"><a href="loops.html#cb351-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Var1 Var2 value prob1 prob2     prob</span></span>
<span id="cb351-5"><a href="loops.html#cb351-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    1    1     2 0.125 0.125 0.015625</span></span>
<span id="cb351-6"><a href="loops.html#cb351-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    2    1     3 0.125 0.125 0.015625</span></span>
<span id="cb351-7"><a href="loops.html#cb351-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    3    1     4 0.125 0.125 0.015625</span></span></code></pre></div>
<p>It is easy to calculate the expected value now that we have each outcome, the value of each outcome, and the probability of each outcome. The expected value will be the summation of the dice values multiplied by the dice probabilities:</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="loops.html#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(rolls<span class="sc">$</span>value <span class="sc">*</span> rolls<span class="sc">$</span>prob)</span>
<span id="cb352-2"><a href="loops.html#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 8.25</span></span></code></pre></div>
<p>So the expected value of rolling two loaded dice is 8.25. If you rolled a pair of loaded dice an infinite number of times, the average sum would be 8.25. (If you are curious, the expected value of rolling a pair of fair dice is 7, which explains why 7 plays such a large role in dice games like craps.)</p>
<p>Now that you’ve warmed up, let’s use our method to calculate the expected value of the slot machine prize. We will follow the same steps we just took:</p>
<ul>
<li>We will list out every possible outcome of playing the machine. This will be a list of every combination of three slot symbols.</li>
<li>We will calculate the probability of getting each combination when you play the machine.</li>
<li>We will determine the prize that we would win for each combination.</li>
</ul>
<p>When we are finished, we will have a data set that looks like this:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="loops.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Var1 Var2 Var3 prob1 prob2 prob3     prob prize</span></span>
<span id="cb353-2"><a href="loops.html#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   DD   DD   DD  0.03  0.03  0.03 0.000027   800</span></span>
<span id="cb353-3"><a href="loops.html#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    7   DD   DD  0.03  0.03  0.03 0.000027     0</span></span>
<span id="cb353-4"><a href="loops.html#cb353-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  BBB   DD   DD  0.06  0.03  0.03 0.000054     0</span></span>
<span id="cb353-5"><a href="loops.html#cb353-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ... and so on.</span></span></code></pre></div>
<p>The expected value will then be the sum of the prizes multiplied by their probability of occuring:</p>
<p><span class="math display">\[
E(\text{prize}) = \sum_{i = 1}^{n}\left( \text{prize}_{i} \cdot P(\text{prize}_{i}) \right)
\]</span></p>
<p>Ready to begin?</p>
<div class="exercise">
<p><span id="exr:unnamed-chunk-49" class="exercise"><strong>Exercise 12.1  (List the Combinations) </strong></span>Use <code>expand.grid</code> to make a data frame that contains every possible combination of <em>three</em> symbols from the <code>wheel</code> vector:</p>
</div>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="loops.html#cb354-1" aria-hidden="true" tabindex="-1"></a>wheel <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DD&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;BBB&quot;</span>, <span class="st">&quot;BB&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;0&quot;</span>)</span></code></pre></div>
<p>Be sure to add the argument <code>stringsAsFactors = FALSE</code> to your <code>expand.grid</code> call; otherwise, <code>expand.grid</code> will save the combinations as factors, an unfortunate choice that will disrupt the <code>score</code> function.</p>
<div class="solution">
<p><span id="unlabeled-div-27" class="solution"><em>Solution</em>. </span>To create a data frame of each combination of <em>three</em> symbols, you need to run <code>expand.grid</code> and give it <em>three</em> copies of <code>wheel</code>. The result will be a data frame with 343 rows, one for each unique combination of three slot symbols:</p>
</div>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="loops.html#cb355-1" aria-hidden="true" tabindex="-1"></a>combos <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(wheel, wheel, wheel, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb355-2"><a href="loops.html#cb355-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-3"><a href="loops.html#cb355-3" aria-hidden="true" tabindex="-1"></a>combos</span>
<span id="cb355-4"><a href="loops.html#cb355-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   Var1 Var2 Var3</span></span>
<span id="cb355-5"><a href="loops.html#cb355-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1   DD   DD   DD</span></span>
<span id="cb355-6"><a href="loops.html#cb355-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2    7   DD   DD</span></span>
<span id="cb355-7"><a href="loops.html#cb355-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 3  BBB   DD   DD</span></span>
<span id="cb355-8"><a href="loops.html#cb355-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 4   BB   DD   DD</span></span>
<span id="cb355-9"><a href="loops.html#cb355-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 5    B   DD   DD</span></span>
<span id="cb355-10"><a href="loops.html#cb355-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 6    C   DD   DD</span></span>
<span id="cb355-11"><a href="loops.html#cb355-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ...</span></span>
<span id="cb355-12"><a href="loops.html#cb355-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 341    B    0    0</span></span>
<span id="cb355-13"><a href="loops.html#cb355-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 342    C    0    0</span></span>
<span id="cb355-14"><a href="loops.html#cb355-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 343    0    0    0</span></span></code></pre></div>
<p>Now, let’s calculate the probability of getting each combination. You can use the probabilities contained in the <code>prob</code> argument of <code>get_symbols</code> to do this. These probabilities determine how frequently each symbol is chosen when your slot machine generates symbols. They were calculated after observing 345 plays of the Manitoba video lottery terminals. Zeroes have the largest chance of being selected (0.52) and cherries the least (0.01):</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="loops.html#cb356-1" aria-hidden="true" tabindex="-1"></a>get_symbols <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb356-2"><a href="loops.html#cb356-2" aria-hidden="true" tabindex="-1"></a>  wheel <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DD&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;BBB&quot;</span>, <span class="st">&quot;BB&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;0&quot;</span>)</span>
<span id="cb356-3"><a href="loops.html#cb356-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(wheel, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb356-4"><a href="loops.html#cb356-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.03</span>, <span class="fl">0.06</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.01</span>, <span class="fl">0.52</span>)</span>
<span id="cb356-5"><a href="loops.html#cb356-5" aria-hidden="true" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-51" class="exercise"><strong>Exercise 12.2  (Make a Lookup Table) </strong></span>Isolate the previous probabilities in a lookup table. What names will you use in your table?</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-28" class="solution"><em>Solution</em>. </span>Your names should match the input that you want to look up. In this case, the input will be the character strings that appear in <code>Var1</code>, <code>Var2</code>, and <code>Var3</code>. So your lookup table should look like this:</p>
</div>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="loops.html#cb357-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DD&quot;</span> <span class="ot">=</span> <span class="fl">0.03</span>, <span class="st">&quot;7&quot;</span> <span class="ot">=</span> <span class="fl">0.03</span>, <span class="st">&quot;BBB&quot;</span> <span class="ot">=</span> <span class="fl">0.06</span>, </span>
<span id="cb357-2"><a href="loops.html#cb357-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;BB&quot;</span> <span class="ot">=</span> <span class="fl">0.1</span>, <span class="st">&quot;B&quot;</span> <span class="ot">=</span> <span class="fl">0.25</span>, <span class="st">&quot;C&quot;</span> <span class="ot">=</span> <span class="fl">0.01</span>, <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="fl">0.52</span>)</span></code></pre></div>
<p>Now let’s look up our probabilities.</p>
<div class="exercise">
<p><span id="exr:unnamed-chunk-53" class="exercise"><strong>Exercise 12.3  (Lookup the Probabilities) </strong></span>Look up the probabilities of getting the values in <code>Var1</code>. Then add them to <code>combos</code> as a column named <code>prob1</code>. Then do the same for <code>Var2</code> (<code>prob2</code>) and <code>Var3</code> (<code>prob3</code>).</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-29" class="solution"><em>Solution</em>. </span>Remember that you use R’s selection notation to look up values in a lookup table. The values that result will be keyed to the index that you use:</p>
</div>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="loops.html#cb358-1" aria-hidden="true" tabindex="-1"></a>combos<span class="sc">$</span>prob1 <span class="ot">&lt;-</span> prob[combos<span class="sc">$</span>Var1]</span>
<span id="cb358-2"><a href="loops.html#cb358-2" aria-hidden="true" tabindex="-1"></a>combos<span class="sc">$</span>prob2 <span class="ot">&lt;-</span> prob[combos<span class="sc">$</span>Var2]</span>
<span id="cb358-3"><a href="loops.html#cb358-3" aria-hidden="true" tabindex="-1"></a>combos<span class="sc">$</span>prob3 <span class="ot">&lt;-</span> prob[combos<span class="sc">$</span>Var3]</span>
<span id="cb358-4"><a href="loops.html#cb358-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-5"><a href="loops.html#cb358-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(combos, <span class="dv">3</span>)</span>
<span id="cb358-6"><a href="loops.html#cb358-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Var1 Var2 Var3 prob1 prob2 prob3</span></span>
<span id="cb358-7"><a href="loops.html#cb358-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   DD   DD   DD  0.03  0.03  0.03</span></span>
<span id="cb358-8"><a href="loops.html#cb358-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    7   DD   DD  0.03  0.03  0.03</span></span>
<span id="cb358-9"><a href="loops.html#cb358-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  BBB   DD   DD  0.06  0.03  0.03</span></span></code></pre></div>
<p>Now how should we calculate the total probability of each combination? Our three slot symbols are all chosen independently, which means that the same rule that governed our dice probabilities governs our symbol probabilities:</p>
<p><span class="math display">\[
P(A \&amp; B \&amp; C \&amp; ...) = P(A) \cdot P(B) \cdot P(C) \cdot ...
\]</span></p>
<div class="exercise">
<p><span id="exr:unnamed-chunk-55" class="exercise"><strong>Exercise 12.4  (Calculate Probabilities for Each Combination) </strong></span>Calculate the overall probabilities for each combination. Save them as a column named <code>prob</code> in <code>combos</code>, then check your work.</p>
<p>You can check that the math worked by summing the probabilities. The probabilities should add up to one, because one of the combinations <em>must</em> appear when you play the slot machine. In other words, a combination will appear, with probability of one.</p>
</div>
<p>You can calculate the probabilities of every possible combination in one fell swoop with some element-wise execution:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="loops.html#cb359-1" aria-hidden="true" tabindex="-1"></a>combos<span class="sc">$</span>prob <span class="ot">&lt;-</span> combos<span class="sc">$</span>prob1 <span class="sc">*</span> combos<span class="sc">$</span>prob2 <span class="sc">*</span> combos<span class="sc">$</span>prob3</span>
<span id="cb359-2"><a href="loops.html#cb359-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-3"><a href="loops.html#cb359-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(combos, <span class="dv">3</span>)</span>
<span id="cb359-4"><a href="loops.html#cb359-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Var1 Var2 Var3 prob1 prob2 prob3     prob</span></span>
<span id="cb359-5"><a href="loops.html#cb359-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   DD   DD   DD  0.03  0.03  0.03 0.000027</span></span>
<span id="cb359-6"><a href="loops.html#cb359-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    7   DD   DD  0.03  0.03  0.03 0.000027</span></span>
<span id="cb359-7"><a href="loops.html#cb359-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  BBB   DD   DD  0.06  0.03  0.03 0.000054</span></span></code></pre></div>
<p>The sum of the probabilities is one, which suggests that our math is correct:</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="loops.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(combos<span class="sc">$</span>prob)</span>
<span id="cb360-2"><a href="loops.html#cb360-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 1</span></span></code></pre></div>
<p>You only need to do one more thing before you can calculate the expected value: you must determine the prize for each combination in <code>combos</code>. You can calculate the prize with <code>score</code>. For example, we can calculate the prize for the first row of <code>combos</code> like this:</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="loops.html#cb361-1" aria-hidden="true" tabindex="-1"></a>symbols <span class="ot">&lt;-</span> <span class="fu">c</span>(combos[<span class="dv">1</span>, <span class="dv">1</span>], combos[<span class="dv">1</span>, <span class="dv">2</span>], combos[<span class="dv">1</span>, <span class="dv">3</span>])</span>
<span id="cb361-2"><a href="loops.html#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;DD&quot; &quot;DD&quot; &quot;DD&quot;</span></span>
<span id="cb361-3"><a href="loops.html#cb361-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-4"><a href="loops.html#cb361-4" aria-hidden="true" tabindex="-1"></a><span class="fu">score</span>(symbols)</span>
<span id="cb361-5"><a href="loops.html#cb361-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 800</span></span></code></pre></div>
<p>However there are 343 rows, which makes for tedious work if you plan to calculate the scores manually. It will be quicker to automate this task and have R do it for you, which you can do with a <code>for</code> loop.</p>
</div>
<div id="for-loops" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> for Loops<a href="loops.html#for-loops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <code>for</code> loop repeats a chunk of code many times, once for each element in a set of input. <code>for</code> loops provide a way to tell R, “Do this for every value of that.” In R syntax, this looks like:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="loops.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (value <span class="cf">in</span> that) {</span>
<span id="cb362-2"><a href="loops.html#cb362-2" aria-hidden="true" tabindex="-1"></a>  this</span>
<span id="cb362-3"><a href="loops.html#cb362-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <code>that</code> object should be a set of objects (often a vector of numbers or character strings). The for loop will run the code in that appears between the braces once for each member of <code>that</code>. For example, the for loop below runs <code>print("one run")</code> once for each element in a vector of character strings:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="loops.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (value <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;My&quot;</span>, <span class="st">&quot;first&quot;</span>, <span class="st">&quot;for&quot;</span>, <span class="st">&quot;loop&quot;</span>)) {</span>
<span id="cb363-2"><a href="loops.html#cb363-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;one run&quot;</span>)</span>
<span id="cb363-3"><a href="loops.html#cb363-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb363-4"><a href="loops.html#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;one run&quot;</span></span>
<span id="cb363-5"><a href="loops.html#cb363-5" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;one run&quot;</span></span>
<span id="cb363-6"><a href="loops.html#cb363-6" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;one run&quot;</span></span>
<span id="cb363-7"><a href="loops.html#cb363-7" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;one run&quot;</span></span></code></pre></div>
<p>The <code>value</code> symbol in a for loop acts like an argument in a function. The for loop will create an object named <code>value</code> and assign it a new value on each run of the loop. The code in your loop can access this value by calling the <code>value</code> object.</p>
<p>What values will the for loop assign to <code>value</code>? It will use the elements in the set that you run the loop on. <code>for</code> starts with the first element and then assigns a different element to <code>value</code> on each run of the for loop, until all of the elements have been assigned to <code>value</code>. For example, the for loop below will run <code>print(value)</code> four times and will print out one element of <code>c("My", "second", "for", "loop")</code> each time:</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="loops.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (value <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;My&quot;</span>, <span class="st">&quot;second&quot;</span>, <span class="st">&quot;for&quot;</span>, <span class="st">&quot;loop&quot;</span>)) {</span>
<span id="cb364-2"><a href="loops.html#cb364-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(value)</span>
<span id="cb364-3"><a href="loops.html#cb364-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb364-4"><a href="loops.html#cb364-4" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;My&quot;</span></span>
<span id="cb364-5"><a href="loops.html#cb364-5" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;second&quot;</span></span>
<span id="cb364-6"><a href="loops.html#cb364-6" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;for&quot;</span></span>
<span id="cb364-7"><a href="loops.html#cb364-7" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;loop&quot;</span></span></code></pre></div>
<p>On the first run, the for loop substituted <code>"My"</code> for <code>value</code> in <code>print(value)</code>. On the second run it substituted <code>"second"</code>, and so on until <code>for</code> had run <code>print(value)</code> once with every element in the set:</p>
<p>If you look at <code>value</code> after the loop runs, you will see that it still contains the value of the last element in the set:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="loops.html#cb365-1" aria-hidden="true" tabindex="-1"></a>value</span>
<span id="cb365-2"><a href="loops.html#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;loop&quot;</span></span></code></pre></div>
<p>I’ve been using the symbol <code>value</code> in my for loops, but there is nothing special about it. You can use any symbol you like in your loop to do the same thing as long as the symbol appears before <code>in</code> in the parentheses that follow <code>for</code>. For example, you could rewrite the previous loop with any of the following:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="loops.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (word <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;My&quot;</span>, <span class="st">&quot;second&quot;</span>, <span class="st">&quot;for&quot;</span>, <span class="st">&quot;loop&quot;</span>)) {</span>
<span id="cb366-2"><a href="loops.html#cb366-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(word)</span>
<span id="cb366-3"><a href="loops.html#cb366-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb366-4"><a href="loops.html#cb366-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (string <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;My&quot;</span>, <span class="st">&quot;second&quot;</span>, <span class="st">&quot;for&quot;</span>, <span class="st">&quot;loop&quot;</span>)) {</span>
<span id="cb366-5"><a href="loops.html#cb366-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(string)</span>
<span id="cb366-6"><a href="loops.html#cb366-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb366-7"><a href="loops.html#cb366-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;My&quot;</span>, <span class="st">&quot;second&quot;</span>, <span class="st">&quot;for&quot;</span>, <span class="st">&quot;loop&quot;</span>)) {</span>
<span id="cb366-8"><a href="loops.html#cb366-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb366-9"><a href="loops.html#cb366-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>

<div class="rmdwarning">
<p><strong>Choose your symbols carefully</strong></p>
R will run your loop in whichever environment you call it from. This is bad news if your loop uses object names that already exist in the environment. Your loop will overwrite the existing objects with the objects that it creates. This applies to the value symbol as well.
</div>

<div class="rmdtip">
<p><strong>For loops run on sets</strong></p>
<p>In many programming languages, <code>for</code> loops are designed to work with integers, not sets. You give the loop a starting value and an ending value, as well as an increment to advance the value by between loops. The <code>for</code> loop then runs until the loop value exceeds the ending value.</p>
You can recreate this effect in R by having a <code>for</code> loop execute on a set of integers, but don’t lose track of the fact that R’s <code>for</code> loops execute on members of a set, not sequences of integers.
</div>
<p><code>for</code> loops are very useful in programming because they help you connect a piece of code with each element in a set. For example, we could use a <code>for</code> loop to run <code>score</code> once for each row in <code>combos</code>. However, R’s <code>for</code> loops have a shortcoming that you’ll want to know about before you start using them: <code>for</code> loops do not return output.</p>
<p><code>for</code> loops are like Las Vegas: what happens in a <code>for</code> loop stays in a <code>for</code> loop. If you want to use the products of a <code>for</code> loop, you must write the <code>for</code> loop so that it saves its own output as it goes.</p>
<p>Our previous examples appeared to return output, but this was misleading. The examples worked because we called <code>print</code>, which always prints its arguments in the console (even if it is called from a function, a <code>for</code> loop, or anything else). Our <code>for</code> loops won’t return anything if you remove the <code>print</code> call:</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="loops.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (value <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;My&quot;</span>, <span class="st">&quot;third&quot;</span>, <span class="st">&quot;for&quot;</span>, <span class="st">&quot;loop&quot;</span>)) {</span>
<span id="cb367-2"><a href="loops.html#cb367-2" aria-hidden="true" tabindex="-1"></a>  value</span>
<span id="cb367-3"><a href="loops.html#cb367-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb367-4"><a href="loops.html#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span></code></pre></div>
<p>To save output from a <code>for</code> loop, you must write the loop so that it saves its own output as it runs. You can do this by creating an empty vector or list before you run the <code>for</code> loop. Then use the <code>for</code> loop to fill up the vector or list. When the <code>for</code> loop is finished, you’ll be able to access the vector or list, which will now have all of your results.</p>
<p>Let’s see this in action. The following code creates an empty vector of length 4:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="loops.html#cb368-1" aria-hidden="true" tabindex="-1"></a>chars <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>The next loop will fill it with strings:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="loops.html#cb369-1" aria-hidden="true" tabindex="-1"></a>words <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;My&quot;</span>, <span class="st">&quot;fourth&quot;</span>, <span class="st">&quot;for&quot;</span>, <span class="st">&quot;loop&quot;</span>)</span>
<span id="cb369-2"><a href="loops.html#cb369-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-3"><a href="loops.html#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb369-4"><a href="loops.html#cb369-4" aria-hidden="true" tabindex="-1"></a>  chars[i] <span class="ot">&lt;-</span> words[i]</span>
<span id="cb369-5"><a href="loops.html#cb369-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb369-6"><a href="loops.html#cb369-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-7"><a href="loops.html#cb369-7" aria-hidden="true" tabindex="-1"></a>chars</span>
<span id="cb369-8"><a href="loops.html#cb369-8" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;My&quot;    &quot;fourth&quot; &quot;for&quot;   &quot;loop&quot;</span></span></code></pre></div>
<p>This approach will usually require you to change the sets that you execute your <code>for</code> loop on. Instead of executing on a set of objects, execute on a set of integers that you can use to index both your object and your storage vector. This approach is very common in R. You’ll find in practice that you use <code>for</code> loops not so much to run code, but to fill up vectors and lists with the results of code.</p>
<p>Let’s use a <code>for</code> loop to calculate the prize for each row in <code>combos</code>. To begin, create a new column in <code>combos</code> to store the results of the <code>for</code> loop:</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="loops.html#cb370-1" aria-hidden="true" tabindex="-1"></a>combos<span class="sc">$</span>prize <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb370-2"><a href="loops.html#cb370-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-3"><a href="loops.html#cb370-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(combos, <span class="dv">3</span>)</span>
<span id="cb370-4"><a href="loops.html#cb370-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Var1 Var2 Var3 prob1 prob2 prob3     prob prize</span></span>
<span id="cb370-5"><a href="loops.html#cb370-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    DD   DD   DD  0.03  0.03  0.03 0.000027    NA</span></span>
<span id="cb370-6"><a href="loops.html#cb370-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     7   DD   DD  0.03  0.03  0.03 0.000027    NA</span></span>
<span id="cb370-7"><a href="loops.html#cb370-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   BBB   DD   DD  0.06  0.03  0.03 0.000054    NA</span></span></code></pre></div>
<p>The code creates a new column named prize and fills it with <code>NA</code>s. R uses its recycling rules to populate every value of the column with <code>NA</code>.</p>
<div class="exercise">
<p><span id="exr:unnamed-chunk-58" class="exercise"><strong>Exercise 12.5  (Build a Loop) </strong></span>Construct a <code>for</code> loop that will run <code>score</code> on all 343 rows of <code>combos</code>. The loop should run <code>score</code> on the first three entries of the _i_th row of <code>combos</code> and should store the results in the _i_th entry of <code>combos$prize</code>.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-30" class="solution"><em>Solution</em>. </span>You can score the rows in <code>combos</code> with:</p>
</div>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="loops.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(combos)) {</span>
<span id="cb371-2"><a href="loops.html#cb371-2" aria-hidden="true" tabindex="-1"></a>  symbols <span class="ot">&lt;-</span> <span class="fu">c</span>(combos[i, <span class="dv">1</span>], combos[i, <span class="dv">2</span>], combos[i, <span class="dv">3</span>])</span>
<span id="cb371-3"><a href="loops.html#cb371-3" aria-hidden="true" tabindex="-1"></a>  combos<span class="sc">$</span>prize[i] <span class="ot">&lt;-</span> <span class="fu">score</span>(symbols)</span>
<span id="cb371-4"><a href="loops.html#cb371-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>After you run the for loop, <code>combos$prize</code> will contain the correct prize for each row. This exercise also tests the <code>score</code> function; <code>score</code> appears to work correctly for every possible slot combination:</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="loops.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(combos, <span class="dv">3</span>)</span>
<span id="cb372-2"><a href="loops.html#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Var1 Var2 Var3 prob1 prob2 prob3     prob prize</span></span>
<span id="cb372-3"><a href="loops.html#cb372-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   DD   DD   DD  0.03  0.03  0.03 0.000027   800</span></span>
<span id="cb372-4"><a href="loops.html#cb372-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    7   DD   DD  0.03  0.03  0.03 0.000027     0</span></span>
<span id="cb372-5"><a href="loops.html#cb372-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  BBB   DD   DD  0.06  0.03  0.03 0.000054     0</span></span></code></pre></div>
<p>We’re now ready to calculate the expected value of the prize. The expected value is the sum of <code>combos$prize</code> weighted by <code>combos$prob</code>. This is also the payout rate of the slot machine:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="loops.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(combos<span class="sc">$</span>prize <span class="sc">*</span> combos<span class="sc">$</span>prob)</span>
<span id="cb373-2"><a href="loops.html#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.538014</span></span></code></pre></div>
<p>Uh oh. The expected prize is about 0.54, which means our slot machine only pays 54 cents on the dollar over the long run. Does this mean that the manufacturer of the Manitoba slot machines <em>was</em> lying?</p>
<p>No, because we ignored an important feature of the slot machine when we wrote <code>score</code>: a diamond is wild. You can treat a <code>DD</code> as any other symbol if it increases your prize, with one exception. You cannot make a <code>DD</code> a <code>C</code> unless you already have another <code>C</code> in your symbols (it’d be too easy if every <code>DD</code> automatically earned you $2).</p>
<p>The best thing about <code>DD</code>s is that their effects are cumulative. For example, consider the combination <code>B</code>, <code>DD</code>, <code>B</code>. Not only does the <code>DD</code> count as a <code>B</code>, which would earn a prize of $10; the <code>DD</code> also doubles the prize to $20.</p>
<p>Adding this behavior to our code is a little tougher than what we have done so far, but it involves all of the same principles. You can decide that your slot machine doesn’t use wilds and keep the code that we have. In that case, your slot machine will have a payout rate of about 54 percent. Or, you could rewrite your code to use wilds. If you do, you will find that your slot machine has a payout rate of 93 percent, one percent higher than the manufacturer’s claim. You can calculate this rate with the same method that we used in this section.</p>
<div class="exercise">
<p><span id="exr:unnamed-chunk-60" class="exercise"><strong>Exercise 12.6  (Challenge) </strong></span>There are many ways to modify <code>score</code> that would count <code>DD</code>s as wild. If you would like to test your skill as an R programmer, try to write your own version of <code>score</code> that correctly handles diamonds.</p>
<p>If you would like a more modest challenge, study the following <code>score</code> code. It accounts for wild diamonds in a way that I find elegant and succinct. See if you can understand each step in the code and how it achieves its result.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-31" class="solution"><em>Solution</em>. </span>Here is a version of score that handles wild diamonds:</p>
</div>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="loops.html#cb374-1" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="cf">function</span>(symbols) {</span>
<span id="cb374-2"><a href="loops.html#cb374-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb374-3"><a href="loops.html#cb374-3" aria-hidden="true" tabindex="-1"></a>  diamonds <span class="ot">&lt;-</span> <span class="fu">sum</span>(symbols <span class="sc">==</span> <span class="st">&quot;DD&quot;</span>)</span>
<span id="cb374-4"><a href="loops.html#cb374-4" aria-hidden="true" tabindex="-1"></a>  cherries <span class="ot">&lt;-</span> <span class="fu">sum</span>(symbols <span class="sc">==</span> <span class="st">&quot;C&quot;</span>)</span>
<span id="cb374-5"><a href="loops.html#cb374-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb374-6"><a href="loops.html#cb374-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># identify case</span></span>
<span id="cb374-7"><a href="loops.html#cb374-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># since diamonds are wild, only nondiamonds </span></span>
<span id="cb374-8"><a href="loops.html#cb374-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># matter for three of a kind and all bars</span></span>
<span id="cb374-9"><a href="loops.html#cb374-9" aria-hidden="true" tabindex="-1"></a>  slots <span class="ot">&lt;-</span> symbols[symbols <span class="sc">!=</span> <span class="st">&quot;DD&quot;</span>]</span>
<span id="cb374-10"><a href="loops.html#cb374-10" aria-hidden="true" tabindex="-1"></a>  same <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(slots)) <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb374-11"><a href="loops.html#cb374-11" aria-hidden="true" tabindex="-1"></a>  bars <span class="ot">&lt;-</span> slots <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;BB&quot;</span>, <span class="st">&quot;BBB&quot;</span>)</span>
<span id="cb374-12"><a href="loops.html#cb374-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-13"><a href="loops.html#cb374-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># assign prize</span></span>
<span id="cb374-14"><a href="loops.html#cb374-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (diamonds <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb374-15"><a href="loops.html#cb374-15" aria-hidden="true" tabindex="-1"></a>    prize <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb374-16"><a href="loops.html#cb374-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (same) {</span>
<span id="cb374-17"><a href="loops.html#cb374-17" aria-hidden="true" tabindex="-1"></a>    payouts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;7&quot;</span> <span class="ot">=</span> <span class="dv">80</span>, <span class="st">&quot;BBB&quot;</span> <span class="ot">=</span> <span class="dv">40</span>, <span class="st">&quot;BB&quot;</span> <span class="ot">=</span> <span class="dv">25</span>,</span>
<span id="cb374-18"><a href="loops.html#cb374-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;B&quot;</span> <span class="ot">=</span> <span class="dv">10</span>, <span class="st">&quot;C&quot;</span> <span class="ot">=</span> <span class="dv">10</span>, <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="dv">0</span>)</span>
<span id="cb374-19"><a href="loops.html#cb374-19" aria-hidden="true" tabindex="-1"></a>    prize <span class="ot">&lt;-</span> <span class="fu">unname</span>(payouts[slots[<span class="dv">1</span>]])</span>
<span id="cb374-20"><a href="loops.html#cb374-20" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">all</span>(bars)) {</span>
<span id="cb374-21"><a href="loops.html#cb374-21" aria-hidden="true" tabindex="-1"></a>    prize <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb374-22"><a href="loops.html#cb374-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cherries <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb374-23"><a href="loops.html#cb374-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># diamonds count as cherries</span></span>
<span id="cb374-24"><a href="loops.html#cb374-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># so long as there is one real cherry</span></span>
<span id="cb374-25"><a href="loops.html#cb374-25" aria-hidden="true" tabindex="-1"></a>    prize <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">5</span>)[cherries <span class="sc">+</span> diamonds <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb374-26"><a href="loops.html#cb374-26" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb374-27"><a href="loops.html#cb374-27" aria-hidden="true" tabindex="-1"></a>    prize <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb374-28"><a href="loops.html#cb374-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb374-29"><a href="loops.html#cb374-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb374-30"><a href="loops.html#cb374-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># double for each diamond</span></span>
<span id="cb374-31"><a href="loops.html#cb374-31" aria-hidden="true" tabindex="-1"></a>  prize <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>diamonds</span>
<span id="cb374-32"><a href="loops.html#cb374-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="exercise">
<p><span id="exr:unnamed-chunk-62" class="exercise"><strong>Exercise 12.7  (Calculate the Expected Value) </strong></span>Calculate the expected value of the slot machine when it uses the new <code>score</code> function. You can use the existing <code>combos</code> data frame, but you will need to build a <code>for</code> loop to recalculate <code>combos$prize</code>.</p>
</div>
<p>To update the expected value, just update <code>combos$prize</code>:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="loops.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(combos)) {</span>
<span id="cb375-2"><a href="loops.html#cb375-2" aria-hidden="true" tabindex="-1"></a>  symbols <span class="ot">&lt;-</span> <span class="fu">c</span>(combos[i, <span class="dv">1</span>], combos[i, <span class="dv">2</span>], combos[i, <span class="dv">3</span>])</span>
<span id="cb375-3"><a href="loops.html#cb375-3" aria-hidden="true" tabindex="-1"></a>  combos<span class="sc">$</span>prize[i] <span class="ot">&lt;-</span> <span class="fu">score</span>(symbols)</span>
<span id="cb375-4"><a href="loops.html#cb375-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then recompute the expected value:</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="loops.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(combos<span class="sc">$</span>prize <span class="sc">*</span> combos<span class="sc">$</span>prob)</span>
<span id="cb376-2"><a href="loops.html#cb376-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.934356</span></span></code></pre></div>
<p>This result vindicates the manufacturer’s claim. If anything, the slot machines seem more generous than the manufacturer stated.</p>
</div>
<div id="while-loops" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> while Loops<a href="loops.html#while-loops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R has two companions to the <code>for</code> loop: the <code>while</code> loop and the <code>repeat</code> loop. A <code>while</code> loop reruns a chunk <em>while</em> a certain condition remains <code>TRUE</code>. To create a <code>while</code> loop, follow <code>while</code> by a condition and a chunk of code, like this:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="loops.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (condition) {</span>
<span id="cb377-2"><a href="loops.html#cb377-2" aria-hidden="true" tabindex="-1"></a>  code</span>
<span id="cb377-3"><a href="loops.html#cb377-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><code>while</code> will rerun <code>condition</code>, which should be a logical test, at the start of each loop. If <code>condition</code> evaluates to <code>TRUE</code>, <code>while</code> will run the code between its braces. If <code>condition</code> evaluates to <code>FALSE</code>, <code>while</code> will finish the loop.</p>
<p>Why might <code>condition</code> change from <code>TRUE</code> to <code>FALSE</code>? Presumably because the code inside your loop has changed whether the condition is still <code>TRUE</code>. If the code has no relationship to the condition, a <code>while</code> loop will run until you stop it. So be careful. You can stop a <code>while</code> loop by hitting Escape or by clicking on the stop-sign icon at the top of the RStudio console pane. The icon will appear once the loop begins to run.</p>
<p>Like <code>for</code> loops, <code>while</code> loops do not return a result, so you must think about what you want the loop to return and save it to an object during the loop.</p>
<p>You can use <code>while</code> loops to do things that take a varying number of iterations, like calculating how long it takes to go broke playing slots (as follows). However, in practice, <code>while</code> loops are much less common than <code>for</code> loops in R:</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="loops.html#cb378-1" aria-hidden="true" tabindex="-1"></a>plays_till_broke <span class="ot">&lt;-</span> <span class="cf">function</span>(start_with) {</span>
<span id="cb378-2"><a href="loops.html#cb378-2" aria-hidden="true" tabindex="-1"></a>  cash <span class="ot">&lt;-</span> start_with</span>
<span id="cb378-3"><a href="loops.html#cb378-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb378-4"><a href="loops.html#cb378-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (cash <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb378-5"><a href="loops.html#cb378-5" aria-hidden="true" tabindex="-1"></a>    cash <span class="ot">&lt;-</span> cash <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">play</span>()</span>
<span id="cb378-6"><a href="loops.html#cb378-6" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb378-7"><a href="loops.html#cb378-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb378-8"><a href="loops.html#cb378-8" aria-hidden="true" tabindex="-1"></a>  n</span>
<span id="cb378-9"><a href="loops.html#cb378-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb378-10"><a href="loops.html#cb378-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-11"><a href="loops.html#cb378-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plays_till_broke</span>(<span class="dv">100</span>)</span>
<span id="cb378-12"><a href="loops.html#cb378-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 260</span></span></code></pre></div>
</div>
<div id="repeat-loops" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> repeat Loops<a href="loops.html#repeat-loops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>repeat</code> loops are even more basic than <code>while</code> loops. They will repeat a chunk of code until you tell them to stop (by hitting Escape) or until they encounter the command <code>break</code>, which will stop the loop.</p>
<p>You can use a <code>repeat</code> loop to recreate <code>plays_till_broke</code>, my function that simulates how long it takes to lose money while playing slots:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="loops.html#cb379-1" aria-hidden="true" tabindex="-1"></a>plays_till_broke <span class="ot">&lt;-</span> <span class="cf">function</span>(start_with) {</span>
<span id="cb379-2"><a href="loops.html#cb379-2" aria-hidden="true" tabindex="-1"></a>  cash <span class="ot">&lt;-</span> start_with</span>
<span id="cb379-3"><a href="loops.html#cb379-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb379-4"><a href="loops.html#cb379-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span> {</span>
<span id="cb379-5"><a href="loops.html#cb379-5" aria-hidden="true" tabindex="-1"></a>    cash <span class="ot">&lt;-</span> cash <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">play</span>()</span>
<span id="cb379-6"><a href="loops.html#cb379-6" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb379-7"><a href="loops.html#cb379-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (cash <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb379-8"><a href="loops.html#cb379-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb379-9"><a href="loops.html#cb379-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb379-10"><a href="loops.html#cb379-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb379-11"><a href="loops.html#cb379-11" aria-hidden="true" tabindex="-1"></a>  n</span>
<span id="cb379-12"><a href="loops.html#cb379-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb379-13"><a href="loops.html#cb379-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-14"><a href="loops.html#cb379-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plays_till_broke</span>(<span class="dv">100</span>)</span>
<span id="cb379-15"><a href="loops.html#cb379-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 237</span></span></code></pre></div>
</div>
<div id="summary" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Summary<a href="loops.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can repeat tasks in R with <code>for</code>, <code>while</code>, and <code>repeat</code> loops. To use <code>for</code>, give it a chunk of code to run and a set of objects to loop through. <code>for</code> will run the code chunk once for each object. If you wish to save the output of your loop, you can assign it to an object that exists outside of the loop.</p>
<p>Repetition plays an important role in data science. It is the basis for simulation, as well as for estimates of variance and probability. Loops are not the only way to create repetition in R (consider <code>replicate</code> for example), but they are one of the most popular ways.</p>
<p>Unfortunately, loops in R can sometimes be slower than loops in other languages. As a result, R’s loops get a bad rap. This reputation is not entirely deserved, but it does highlight an important issue. Speed is essential to data analysis. When your code runs fast, you can work with bigger data and do more to it before you run out of time or computational power. <a href="speed.html#speed">Speed</a> will teach you how to write fast <code>for</code> loops and fast code in general with R. There, you will learn to write vectorized code, a style of lightning-fast code that takes advantage of all of R’s strengths.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="s3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="speed.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/davidrsch/hopres/edit/main/loops.rmd",
"text": "Editar"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
