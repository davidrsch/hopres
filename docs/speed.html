<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 Velocidad | Programación práctica con R</title>
  <meta name="description" content="Este libro le enseñará cómo programar en R, con ejemplos prácticos. Lo escribí para personas que no son programadores para proporcionar una introducción amigable al lenguaje R. Aprenderá a cargar datos, ensamblar y desensamblar objetos de datos, navegar por el sistema de entorno de R, escribir sus propias funciones y utilizar todas las herramientas de programación de R. A lo largo del libro, utilizará sus nuevas habilidades para resolver problemas prácticos de ciencia de datos." />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="13 Velocidad | Programación práctica con R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/davidrsch/hopres/cover.png" />
  <meta property="og:description" content="Este libro le enseñará cómo programar en R, con ejemplos prácticos. Lo escribí para personas que no son programadores para proporcionar una introducción amigable al lenguaje R. Aprenderá a cargar datos, ensamblar y desensamblar objetos de datos, navegar por el sistema de entorno de R, escribir sus propias funciones y utilizar todas las herramientas de programación de R. A lo largo del libro, utilizará sus nuevas habilidades para resolver problemas prácticos de ciencia de datos." />
  <meta name="github-repo" content="davidrsch/hopres" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 Velocidad | Programación práctica con R" />
  
  <meta name="twitter:description" content="Este libro le enseñará cómo programar en R, con ejemplos prácticos. Lo escribí para personas que no son programadores para proporcionar una introducción amigable al lenguaje R. Aprenderá a cargar datos, ensamblar y desensamblar objetos de datos, navegar por el sistema de entorno de R, escribir sus propias funciones y utilizar todas las herramientas de programación de R. A lo largo del libro, utilizará sus nuevas habilidades para resolver problemas prácticos de ciencia de datos." />
  <meta name="twitter:image" content="https://github.com/davidrsch/hopres/cover.png" />

<meta name="author" content="Garrett Grolemund" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="loops.html"/>
<link rel="next" href="starting.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="hopr.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Programación práctica con R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-la-traducción"><i class="fa fa-check"></i>Sobre la traducción</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-la-versión-original-en-inglés"><i class="fa fa-check"></i>Sobre la versión original en inglés</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html"><i class="fa fa-check"></i>Prefacio</a>
<ul>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html#convenciones-usadas-en-este-libro"><i class="fa fa-check"></i>Convenciones Usadas en Este Libro</a></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html#reconocimientos"><i class="fa fa-check"></i>Reconocimientos</a></li>
</ul></li>
<li class="part"><span><b>I Parte 1</b></span></li>
<li class="chapter" data-level="1" data-path="dice.html"><a href="dice.html"><i class="fa fa-check"></i><b>1</b> Proyecto 1: Dados Ponderados</a></li>
<li class="chapter" data-level="2" data-path="Básico.html"><a href="Básico.html"><i class="fa fa-check"></i><b>2</b> Lo Más Básico</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Básico.html"><a href="Básico.html#la-interfaz-de-usuario-de-r"><i class="fa fa-check"></i><b>2.1</b> La Interfaz de Usuario de R</a></li>
<li class="chapter" data-level="2.2" data-path="Básico.html"><a href="Básico.html#objetos"><i class="fa fa-check"></i><b>2.2</b> Objetos</a></li>
<li class="chapter" data-level="2.3" data-path="Básico.html"><a href="Básico.html#funciones"><i class="fa fa-check"></i><b>2.3</b> Funciones</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="Básico.html"><a href="Básico.html#muestra-con-reemplazo"><i class="fa fa-check"></i><b>2.3.1</b> Muestra con reemplazo</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Básico.html"><a href="Básico.html#Escribir-funciones"><i class="fa fa-check"></i><b>2.4</b> Escribiendo Sus Propias Funciones</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="Básico.html"><a href="Básico.html#el-constructor-de-funciones"><i class="fa fa-check"></i><b>2.4.1</b> El Constructor de Funciones</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="Básico.html"><a href="Básico.html#argumentos"><i class="fa fa-check"></i><b>2.5</b> Argumentos</a></li>
<li class="chapter" data-level="2.6" data-path="Básico.html"><a href="Básico.html#scripts"><i class="fa fa-check"></i><b>2.6</b> Scripts</a></li>
<li class="chapter" data-level="2.7" data-path="Básico.html"><a href="Básico.html#resumen"><i class="fa fa-check"></i><b>2.7</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>3</b> Paquetes y páginas de ayuda</a>
<ul>
<li class="chapter" data-level="3.1" data-path="packages.html"><a href="packages.html#paquetes"><i class="fa fa-check"></i><b>3.1</b> Paquetes</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="packages.html"><a href="packages.html#install.packages"><i class="fa fa-check"></i><b>3.1.1</b> install.packages</a></li>
<li class="chapter" data-level="3.1.2" data-path="packages.html"><a href="packages.html#library"><i class="fa fa-check"></i><b>3.1.2</b> library</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="packages.html"><a href="packages.html#obteniendo-ayuda-con-las-páginas-de-ayuda"><i class="fa fa-check"></i><b>3.2</b> Obteniendo Ayuda con las Páginas de Ayuda</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="packages.html"><a href="packages.html#partes-de-una-página-de-ayuda"><i class="fa fa-check"></i><b>3.2.1</b> Partes de una Página de Ayuda</a></li>
<li class="chapter" data-level="3.2.2" data-path="packages.html"><a href="packages.html#obteniendo-más-ayuda"><i class="fa fa-check"></i><b>3.2.2</b> Obteniendo Más Ayuda</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="packages.html"><a href="packages.html#resumen-1"><i class="fa fa-check"></i><b>3.3</b> Resumen</a></li>
<li class="chapter" data-level="3.4" data-path="packages.html"><a href="packages.html#resumen-del-proyecto-1"><i class="fa fa-check"></i><b>3.4</b> Resumen del Proyecto 1</a></li>
</ul></li>
<li class="part"><span><b>II Parte 2</b></span></li>
<li class="chapter" data-level="4" data-path="cards.html"><a href="cards.html"><i class="fa fa-check"></i><b>4</b> Proyecto 2: Baraja de Cartas</a></li>
<li class="chapter" data-level="5" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>5</b> Objectos de R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="objects.html"><a href="objects.html#vectores-atómicos"><i class="fa fa-check"></i><b>5.1</b> Vectores Atómicos</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="objects.html"><a href="objects.html#dobles"><i class="fa fa-check"></i><b>5.1.1</b> Dobles</a></li>
<li class="chapter" data-level="5.1.2" data-path="objects.html"><a href="objects.html#enteros"><i class="fa fa-check"></i><b>5.1.2</b> Enteros</a></li>
<li class="chapter" data-level="5.1.3" data-path="objects.html"><a href="objects.html#caracteres"><i class="fa fa-check"></i><b>5.1.3</b> Caracteres</a></li>
<li class="chapter" data-level="5.1.4" data-path="objects.html"><a href="objects.html#lógicos"><i class="fa fa-check"></i><b>5.1.4</b> Lógicos</a></li>
<li class="chapter" data-level="5.1.5" data-path="objects.html"><a href="objects.html#complejo-y-sin-procesar"><i class="fa fa-check"></i><b>5.1.5</b> Complejo y Sin Procesar</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="objects.html"><a href="objects.html#attributes"><i class="fa fa-check"></i><b>5.2</b> Atributos</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="objects.html"><a href="objects.html#names"><i class="fa fa-check"></i><b>5.2.1</b> Nombres</a></li>
<li class="chapter" data-level="5.2.2" data-path="objects.html"><a href="objects.html#dimensiones"><i class="fa fa-check"></i><b>5.2.2</b> Dimensiones</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="objects.html"><a href="objects.html#matrices"><i class="fa fa-check"></i><b>5.3</b> Matrices</a></li>
<li class="chapter" data-level="5.4" data-path="objects.html"><a href="objects.html#arreglos"><i class="fa fa-check"></i><b>5.4</b> Arreglos</a></li>
<li class="chapter" data-level="5.5" data-path="objects.html"><a href="objects.html#clases"><i class="fa fa-check"></i><b>5.5</b> Clases</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="objects.html"><a href="objects.html#fechas-y-horarios"><i class="fa fa-check"></i><b>5.5.1</b> Fechas y Horarios</a></li>
<li class="chapter" data-level="5.5.2" data-path="objects.html"><a href="objects.html#factores"><i class="fa fa-check"></i><b>5.5.2</b> Factores</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="objects.html"><a href="objects.html#coerción"><i class="fa fa-check"></i><b>5.6</b> Coerción</a></li>
<li class="chapter" data-level="5.7" data-path="objects.html"><a href="objects.html#listas"><i class="fa fa-check"></i><b>5.7</b> Listas</a></li>
<li class="chapter" data-level="5.8" data-path="objects.html"><a href="objects.html#data-frames"><i class="fa fa-check"></i><b>5.8</b> Data Frames</a></li>
<li class="chapter" data-level="5.9" data-path="objects.html"><a href="objects.html#loading"><i class="fa fa-check"></i><b>5.9</b> Cargar Datos</a></li>
<li class="chapter" data-level="5.10" data-path="objects.html"><a href="objects.html#guardar-datos"><i class="fa fa-check"></i><b>5.10</b> Guardar Datos</a></li>
<li class="chapter" data-level="5.11" data-path="objects.html"><a href="objects.html#resumen-2"><i class="fa fa-check"></i><b>5.11</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="notation.html"><a href="notation.html"><i class="fa fa-check"></i><b>6</b> Notación de R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="notation.html"><a href="notation.html#selección-de-valores"><i class="fa fa-check"></i><b>6.1</b> Selección de Valores</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="notation.html"><a href="notation.html#números-enteros-positivos"><i class="fa fa-check"></i><b>6.1.1</b> Números Enteros Positivos</a></li>
<li class="chapter" data-level="6.1.2" data-path="notation.html"><a href="notation.html#números-enteros-negativos"><i class="fa fa-check"></i><b>6.1.2</b> Números Enteros Negativos</a></li>
<li class="chapter" data-level="6.1.3" data-path="notation.html"><a href="notation.html#cero"><i class="fa fa-check"></i><b>6.1.3</b> Cero</a></li>
<li class="chapter" data-level="6.1.4" data-path="notation.html"><a href="notation.html#espacios-en-blanco"><i class="fa fa-check"></i><b>6.1.4</b> Espacios en Blanco</a></li>
<li class="chapter" data-level="6.1.5" data-path="notation.html"><a href="notation.html#logic"><i class="fa fa-check"></i><b>6.1.5</b> Valores Lógicos</a></li>
<li class="chapter" data-level="6.1.6" data-path="notation.html"><a href="notation.html#nombres"><i class="fa fa-check"></i><b>6.1.6</b> Nombres</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="notation.html"><a href="notation.html#repartir-una-carta"><i class="fa fa-check"></i><b>6.2</b> Repartir una Carta</a></li>
<li class="chapter" data-level="6.3" data-path="notation.html"><a href="notation.html#barajar-el-mazo"><i class="fa fa-check"></i><b>6.3</b> Barajar el Mazo</a></li>
<li class="chapter" data-level="6.4" data-path="notation.html"><a href="notation.html#signos-de-dólar-y-corchetes-dobles"><i class="fa fa-check"></i><b>6.4</b> Signos de Dólar y Corchetes Dobles</a></li>
<li class="chapter" data-level="6.5" data-path="notation.html"><a href="notation.html#resumen-3"><i class="fa fa-check"></i><b>6.5</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modify.html"><a href="modify.html"><i class="fa fa-check"></i><b>7</b> Modificación de Valores</a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="modify.html"><a href="modify.html#cambio-de-valores-en-el-lugar"><i class="fa fa-check"></i><b>7.0.1</b> Cambio de Valores en el Lugar</a></li>
<li class="chapter" data-level="7.0.2" data-path="modify.html"><a href="modify.html#subconjunto-lógico"><i class="fa fa-check"></i><b>7.0.2</b> Subconjunto Lógico</a></li>
<li class="chapter" data-level="7.0.3" data-path="modify.html"><a href="modify.html#missing"><i class="fa fa-check"></i><b>7.0.3</b> Información Faltante</a></li>
<li class="chapter" data-level="7.0.4" data-path="modify.html"><a href="modify.html#resumen-4"><i class="fa fa-check"></i><b>7.0.4</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="environment.html"><a href="environment.html"><i class="fa fa-check"></i><b>8</b> Entornos</a>
<ul>
<li class="chapter" data-level="8.1" data-path="environment.html"><a href="environment.html#entornos"><i class="fa fa-check"></i><b>8.1</b> Entornos</a></li>
<li class="chapter" data-level="8.2" data-path="environment.html"><a href="environment.html#trabajar-con-entornos"><i class="fa fa-check"></i><b>8.2</b> Trabajar con Entornos</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="environment.html"><a href="environment.html#el-entorno-activo"><i class="fa fa-check"></i><b>8.2.1</b> El Entorno Activo</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="environment.html"><a href="environment.html#reglas-de-alcance"><i class="fa fa-check"></i><b>8.3</b> Reglas de Alcance</a></li>
<li class="chapter" data-level="8.4" data-path="environment.html"><a href="environment.html#asignación"><i class="fa fa-check"></i><b>8.4</b> Asignación</a></li>
<li class="chapter" data-level="8.5" data-path="environment.html"><a href="environment.html#evaluación"><i class="fa fa-check"></i><b>8.5</b> Evaluación</a></li>
<li class="chapter" data-level="8.6" data-path="environment.html"><a href="environment.html#cierres"><i class="fa fa-check"></i><b>8.6</b> Cierres</a></li>
<li class="chapter" data-level="8.7" data-path="environment.html"><a href="environment.html#resumen-5"><i class="fa fa-check"></i><b>8.7</b> Resumen</a></li>
<li class="chapter" data-level="8.8" data-path="environment.html"><a href="environment.html#resumen-del-proyecto-2"><i class="fa fa-check"></i><b>8.8</b> Resumen del Proyecto 2</a></li>
</ul></li>
<li class="part"><span><b>III Parte 3</b></span></li>
<li class="chapter" data-level="9" data-path="slots.html"><a href="slots.html"><i class="fa fa-check"></i><b>9</b> Proyecto 3: Máquina Tragamonedas</a></li>
<li class="chapter" data-level="10" data-path="programs.html"><a href="programs.html"><i class="fa fa-check"></i><b>10</b> Programas</a>
<ul>
<li class="chapter" data-level="10.1" data-path="programs.html"><a href="programs.html#estrategia"><i class="fa fa-check"></i><b>10.1</b> Estrategia</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="programs.html"><a href="programs.html#pasos-secuenciales"><i class="fa fa-check"></i><b>10.1.1</b> Pasos Secuenciales</a></li>
<li class="chapter" data-level="10.1.2" data-path="programs.html"><a href="programs.html#casos-paralelos"><i class="fa fa-check"></i><b>10.1.2</b> Casos Paralelos</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="programs.html"><a href="programs.html#declaraciones-if"><i class="fa fa-check"></i><b>10.2</b> Declaraciones if</a></li>
<li class="chapter" data-level="10.3" data-path="programs.html"><a href="programs.html#declaraciones-else"><i class="fa fa-check"></i><b>10.3</b> Declaraciones else</a></li>
<li class="chapter" data-level="10.4" data-path="programs.html"><a href="programs.html#tablas-de-búsqueda"><i class="fa fa-check"></i><b>10.4</b> Tablas de Búsqueda</a></li>
<li class="chapter" data-level="10.5" data-path="programs.html"><a href="programs.html#comentarios-de-código"><i class="fa fa-check"></i><b>10.5</b> Comentarios de Código</a></li>
<li class="chapter" data-level="10.6" data-path="programs.html"><a href="programs.html#resumen-6"><i class="fa fa-check"></i><b>10.6</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="s3.html"><a href="s3.html"><i class="fa fa-check"></i><b>11</b> S3</a>
<ul>
<li class="chapter" data-level="11.1" data-path="s3.html"><a href="s3.html#el-sistema-s3"><i class="fa fa-check"></i><b>11.1</b> El Sistema S3</a></li>
<li class="chapter" data-level="11.2" data-path="s3.html"><a href="s3.html#atributos"><i class="fa fa-check"></i><b>11.2</b> Atributos</a></li>
<li class="chapter" data-level="11.3" data-path="s3.html"><a href="s3.html#funciones-genéricas"><i class="fa fa-check"></i><b>11.3</b> Funciones Genéricas</a></li>
<li class="chapter" data-level="11.4" data-path="s3.html"><a href="s3.html#métodos"><i class="fa fa-check"></i><b>11.4</b> Métodos</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="s3.html"><a href="s3.html#selección-de-método"><i class="fa fa-check"></i><b>11.4.1</b> Selección de Método</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="s3.html"><a href="s3.html#clases-1"><i class="fa fa-check"></i><b>11.5</b> Clases</a></li>
<li class="chapter" data-level="11.6" data-path="s3.html"><a href="s3.html#s3-y-depuración"><i class="fa fa-check"></i><b>11.6</b> S3 y Depuración</a></li>
<li class="chapter" data-level="11.7" data-path="s3.html"><a href="s3.html#s4-y-r5"><i class="fa fa-check"></i><b>11.7</b> S4 y R5</a></li>
<li class="chapter" data-level="11.8" data-path="s3.html"><a href="s3.html#resumen-7"><i class="fa fa-check"></i><b>11.8</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>12</b> Bucles</a>
<ul>
<li class="chapter" data-level="12.1" data-path="loops.html"><a href="loops.html#valores-esperados"><i class="fa fa-check"></i><b>12.1</b> Valores Esperados</a></li>
<li class="chapter" data-level="12.2" data-path="loops.html"><a href="loops.html#expand.grid"><i class="fa fa-check"></i><b>12.2</b> expand.grid</a></li>
<li class="chapter" data-level="12.3" data-path="loops.html"><a href="loops.html#bucles-for"><i class="fa fa-check"></i><b>12.3</b> Bucles for</a></li>
<li class="chapter" data-level="12.4" data-path="loops.html"><a href="loops.html#bucles-while"><i class="fa fa-check"></i><b>12.4</b> Bucles while</a></li>
<li class="chapter" data-level="12.5" data-path="loops.html"><a href="loops.html#bucles-repeat"><i class="fa fa-check"></i><b>12.5</b> Bucles repeat</a></li>
<li class="chapter" data-level="12.6" data-path="loops.html"><a href="loops.html#resumen-8"><i class="fa fa-check"></i><b>12.6</b> Resumen</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="speed.html"><a href="speed.html"><i class="fa fa-check"></i><b>13</b> Velocidad</a>
<ul>
<li class="chapter" data-level="13.1" data-path="speed.html"><a href="speed.html#código-vectorizado"><i class="fa fa-check"></i><b>13.1</b> Código Vectorizado</a></li>
<li class="chapter" data-level="13.2" data-path="speed.html"><a href="speed.html#cómo-escribir-código-vectorizado"><i class="fa fa-check"></i><b>13.2</b> Cómo Escribir Código Vectorizado</a></li>
<li class="chapter" data-level="13.3" data-path="speed.html"><a href="speed.html#cómo-escribir-bucles-for-rápidos-en-r"><i class="fa fa-check"></i><b>13.3</b> Cómo Escribir Bucles for Rápidos en R</a></li>
<li class="chapter" data-level="13.4" data-path="speed.html"><a href="speed.html#código-vectorizado-en-la-práctica"><i class="fa fa-check"></i><b>13.4</b> Código Vectorizado en la Práctica</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="speed.html"><a href="speed.html#bucles-vs-código-vectorizado"><i class="fa fa-check"></i><b>13.4.1</b> Bucles vs Código Vectorizado</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="speed.html"><a href="speed.html#resumen-9"><i class="fa fa-check"></i><b>13.5</b> Resumen</a></li>
<li class="chapter" data-level="13.6" data-path="speed.html"><a href="speed.html#resumen-del-proyecto-3"><i class="fa fa-check"></i><b>13.6</b> Resumen del Proyecto 3</a></li>
</ul></li>
<li class="appendix"><span><b>Apéndice</b></span></li>
<li class="chapter" data-level="A" data-path="starting.html"><a href="starting.html"><i class="fa fa-check"></i><b>A</b> Instalación de R y RStudio</a>
<ul>
<li class="chapter" data-level="A.1" data-path="starting.html"><a href="starting.html#cómo-descargar-e-instalar-r"><i class="fa fa-check"></i><b>A.1</b> Cómo descargar e instalar R</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="starting.html"><a href="starting.html#windows"><i class="fa fa-check"></i><b>A.1.1</b> Windows</a></li>
<li class="chapter" data-level="A.1.2" data-path="starting.html"><a href="starting.html#mac"><i class="fa fa-check"></i><b>A.1.2</b> Mac</a></li>
<li class="chapter" data-level="A.1.3" data-path="starting.html"><a href="starting.html#linux"><i class="fa fa-check"></i><b>A.1.3</b> Linux</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="starting.html"><a href="starting.html#usando-r"><i class="fa fa-check"></i><b>A.2</b> Usando R</a></li>
<li class="chapter" data-level="A.3" data-path="starting.html"><a href="starting.html#rstudio"><i class="fa fa-check"></i><b>A.3</b> RStudio</a></li>
<li class="chapter" data-level="A.4" data-path="starting.html"><a href="starting.html#abriendo-r"><i class="fa fa-check"></i><b>A.4</b> Abriendo R</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="packages2.html"><a href="packages2.html"><i class="fa fa-check"></i><b>B</b> Paquetes de R</a>
<ul>
<li class="chapter" data-level="B.1" data-path="packages2.html"><a href="packages2.html#instalando-paquetes"><i class="fa fa-check"></i><b>B.1</b> Instalando Paquetes</a></li>
<li class="chapter" data-level="B.2" data-path="packages2.html"><a href="packages2.html#cargando-paquetes"><i class="fa fa-check"></i><b>B.2</b> Cargando Paquetes</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="updating.html"><a href="updating.html"><i class="fa fa-check"></i><b>C</b> Updating R and Its Packages</a>
<ul>
<li class="chapter" data-level="C.1" data-path="updating.html"><a href="updating.html#r-packages"><i class="fa fa-check"></i><b>C.1</b> R Packages</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="dataio.html"><a href="dataio.html"><i class="fa fa-check"></i><b>D</b> Cargar y Guardar Datos en R</a>
<ul>
<li class="chapter" data-level="D.1" data-path="dataio.html"><a href="dataio.html#conjuntos-de-datos-en-r-base"><i class="fa fa-check"></i><b>D.1</b> Conjuntos de Datos en R Base</a></li>
<li class="chapter" data-level="D.2" data-path="dataio.html"><a href="dataio.html#directorio-de-trabajo"><i class="fa fa-check"></i><b>D.2</b> Directorio de Trabajo</a></li>
<li class="chapter" data-level="D.3" data-path="dataio.html"><a href="dataio.html#archivos-de-texto-sin-formato"><i class="fa fa-check"></i><b>D.3</b> Archivos de Texto Sin Formato</a>
<ul>
<li class="chapter" data-level="D.3.1" data-path="dataio.html"><a href="dataio.html#read.table"><i class="fa fa-check"></i><b>D.3.1</b> read.table</a></li>
<li class="chapter" data-level="D.3.2" data-path="dataio.html"><a href="dataio.html#la-familia-read"><i class="fa fa-check"></i><b>D.3.2</b> La Familia read</a></li>
<li class="chapter" data-level="D.3.3" data-path="dataio.html"><a href="dataio.html#read.fwf"><i class="fa fa-check"></i><b>D.3.3</b> read.fwf</a></li>
<li class="chapter" data-level="D.3.4" data-path="dataio.html"><a href="dataio.html#links-html"><i class="fa fa-check"></i><b>D.3.4</b> Links HTML</a></li>
<li class="chapter" data-level="D.3.5" data-path="dataio.html"><a href="dataio.html#guardar-archivos-de-texto-sin-formato"><i class="fa fa-check"></i><b>D.3.5</b> Guardar Archivos de Texto Sin Formato</a></li>
<li class="chapter" data-level="D.3.6" data-path="dataio.html"><a href="dataio.html#comprimiendo-archivos"><i class="fa fa-check"></i><b>D.3.6</b> Comprimiendo Archivos</a></li>
</ul></li>
<li class="chapter" data-level="D.4" data-path="dataio.html"><a href="dataio.html#archivos-de-r"><i class="fa fa-check"></i><b>D.4</b> Archivos de R</a>
<ul>
<li class="chapter" data-level="D.4.1" data-path="dataio.html"><a href="dataio.html#guardar-archivos-de-r"><i class="fa fa-check"></i><b>D.4.1</b> Guardar archivos de R</a></li>
</ul></li>
<li class="chapter" data-level="D.5" data-path="dataio.html"><a href="dataio.html#hojas-de-cálculo-de-excel"><i class="fa fa-check"></i><b>D.5</b> Hojas de Cálculo de Excel</a>
<ul>
<li class="chapter" data-level="D.5.1" data-path="dataio.html"><a href="dataio.html#exportar-desde-excel"><i class="fa fa-check"></i><b>D.5.1</b> Exportar desde Excel</a></li>
<li class="chapter" data-level="D.5.2" data-path="dataio.html"><a href="dataio.html#copiar-y-pegar"><i class="fa fa-check"></i><b>D.5.2</b> Copiar y pegar</a></li>
<li class="chapter" data-level="D.5.3" data-path="dataio.html"><a href="dataio.html#xlconnect"><i class="fa fa-check"></i><b>D.5.3</b> XLConnect</a></li>
<li class="chapter" data-level="D.5.4" data-path="dataio.html"><a href="dataio.html#lectura-de-hojas-de-cálculo"><i class="fa fa-check"></i><b>D.5.4</b> Lectura de Hojas de Cálculo</a></li>
<li class="chapter" data-level="D.5.5" data-path="dataio.html"><a href="dataio.html#escribir-hojas-de-cálculo"><i class="fa fa-check"></i><b>D.5.5</b> Escribir Hojas de Cálculo</a></li>
</ul></li>
<li class="chapter" data-level="D.6" data-path="dataio.html"><a href="dataio.html#cargar-archivos-desde-otros-programas"><i class="fa fa-check"></i><b>D.6</b> Cargar Archivos desde Otros Programas</a>
<ul>
<li class="chapter" data-level="D.6.1" data-path="dataio.html"><a href="dataio.html#conexión-a-bases-de-datos"><i class="fa fa-check"></i><b>D.6.1</b> Conexión a bases de datos</a></li>
</ul></li>
<li class="chapter" data-level="D.7" data-path="dataio.html"><a href="dataio.html#actualización"><i class="fa fa-check"></i><b>D.7</b> Actualización</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="debug.html"><a href="debug.html"><i class="fa fa-check"></i><b>E</b> Depuración de Código de R</a>
<ul>
<li class="chapter" data-level="E.1" data-path="debug.html"><a href="debug.html#traceback"><i class="fa fa-check"></i><b>E.1</b> traceback</a></li>
<li class="chapter" data-level="E.2" data-path="debug.html"><a href="debug.html#browser"><i class="fa fa-check"></i><b>E.2</b> browser</a></li>
<li class="chapter" data-level="E.3" data-path="debug.html"><a href="debug.html#puntos-de-ruptura"><i class="fa fa-check"></i><b>E.3</b> Puntos de Ruptura</a></li>
<li class="chapter" data-level="E.4" data-path="debug.html"><a href="debug.html#debug-1"><i class="fa fa-check"></i><b>E.4</b> debug</a></li>
<li class="chapter" data-level="E.5" data-path="debug.html"><a href="debug.html#trace"><i class="fa fa-check"></i><b>E.5</b> trace</a></li>
<li class="chapter" data-level="E.6" data-path="debug.html"><a href="debug.html#recover"><i class="fa fa-check"></i><b>E.6</b> recover</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Programación práctica con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="speed" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">13</span> Velocidad<a href="speed.html#speed" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Como científico de datos, necesita velocidad. Puede trabajar con datos más grandes y realizar tareas más ambiciosas cuando su código se ejecuta rápidamente. Este capítulo le mostrará una forma específica de escribir código rápido en R. Luego usará el método para simular 10 millones de juegos de su máquina tragamonedas.</p>
<div id="código-vectorizado" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Código Vectorizado<a href="speed.html#código-vectorizado" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Puede escribir una pieza de código de muchas maneras diferentes, pero el código R más rápido generalmente aprovechará tres cosas: pruebas lógicas, creación de subconjuntos y ejecución de elementos. Estas son las cosas que R hace mejor. El código que usa estas cosas suele tener una cierta cualidad: está <em>vectorizado</em>; el código puede tomar un vector de valores como entrada y manipular cada valor en el vector al mismo tiempo.</p>
<p>Para ver cómo se ve el código vectorizado, compare estos dos ejemplos de una función de valor absoluto. Cada uno toma un vector de números y lo transforma en un vector de valores absolutos (por ejemplo, números positivos). El primer ejemplo no está vectorizado; <code>abs_bucle</code> usa un bucle <code>for</code> para manipular cada elemento del vector uno a la vez:</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="speed.html#cb380-1" aria-hidden="true" tabindex="-1"></a>abs_bucle <span class="ot">&lt;-</span> <span class="cf">function</span>(vec){</span>
<span id="cb380-2"><a href="speed.html#cb380-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(vec)) {</span>
<span id="cb380-3"><a href="speed.html#cb380-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (vec[i] <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb380-4"><a href="speed.html#cb380-4" aria-hidden="true" tabindex="-1"></a>      vec[i] <span class="ot">&lt;-</span> <span class="sc">-</span>vec[i]</span>
<span id="cb380-5"><a href="speed.html#cb380-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb380-6"><a href="speed.html#cb380-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb380-7"><a href="speed.html#cb380-7" aria-hidden="true" tabindex="-1"></a>  vec</span>
<span id="cb380-8"><a href="speed.html#cb380-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>El segundo ejemplo, <code>abs_set</code>, es una versión vectorizada de <code>abs_bucle</code>. Utiliza subconjuntos lógicos para manipular todos los números negativos en el vector al mismo tiempo:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="speed.html#cb381-1" aria-hidden="true" tabindex="-1"></a>abs_sets <span class="ot">&lt;-</span> <span class="cf">function</span>(vec){</span>
<span id="cb381-2"><a href="speed.html#cb381-2" aria-hidden="true" tabindex="-1"></a>  negs <span class="ot">&lt;-</span> vec <span class="sc">&lt;</span> <span class="dv">0</span></span>
<span id="cb381-3"><a href="speed.html#cb381-3" aria-hidden="true" tabindex="-1"></a>  vec[negs] <span class="ot">&lt;-</span> vec[negs] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb381-4"><a href="speed.html#cb381-4" aria-hidden="true" tabindex="-1"></a>  vec</span>
<span id="cb381-5"><a href="speed.html#cb381-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><code>abs_set</code> es mucho más rápido que <code>abs_bucle</code> porque se basa en operaciones que R realiza rápidamente: pruebas lógicas, creación de subconjuntos y ejecución de elementos.</p>
<p>Puedes usar la función <code>system.time</code> para ver qué tan rápido es <code>abs_set</code>. <code>system.time</code> toma una expresión R, la ejecuta y luego muestra cuánto tiempo transcurrió mientras se ejecutaba la expresión.</p>
<p>Para comparar <code>abs_bucle</code> y <code>abs_set</code>, primero haga un vector largo de números positivos y negativos. <code>largo</code> contendrá 10 millones de valores:</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="speed.html#cb382-1" aria-hidden="true" tabindex="-1"></a>largo <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">5000000</span>)</span></code></pre></div>

<div class="rmdnote">
<code>rep</code> repite un valor, o vector de valores, muchas veces. Para usar <code>rep</code>, dale un vector de valores y luego el número de veces para repetir el vector. R devolverá los resultados como un nuevo vector más largo.
</div>
<p>Luego puede usar <code>system.time</code> para medir cuánto tiempo le toma a cada función evaluar <code>largo</code>:</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="speed.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">abs_bucle</span>(largo))</span>
<span id="cb383-2"><a href="speed.html#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="do">##    user  system elapsed </span></span>
<span id="cb383-3"><a href="speed.html#cb383-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  15.982   0.032  16.018</span></span>
<span id="cb383-4"><a href="speed.html#cb383-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-5"><a href="speed.html#cb383-5" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">abs_sets</span>(largo))</span>
<span id="cb383-6"><a href="speed.html#cb383-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    user  system elapsed </span></span>
<span id="cb383-7"><a href="speed.html#cb383-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   0.529   0.063   0.592</span></span></code></pre></div>

<div class="rmdimportant">
No confunda <code>system.time</code> con <code>Sys.time</code>, que devuelve la hora actual.
</div>
<p>Las primeras dos columnas de la salida de <code>system.time</code> informan cuántos segundos pasó su computadora ejecutando la llamada en el lado del usuario y en el lado del sistema de su proceso, una dicotomía que variará de un sistema operativo a otro.</p>
<p>La última columna muestra cuántos segundos transcurrieron mientras R ejecutaba la expresión. Los resultados muestran que <code>abs_set</code> calculó el valor absoluto 30 veces más rápido que <code>abs_bucle</code> cuando se aplicó a un vector de 10 millones de números. Puede esperar aceleraciones similares siempre que escriba código vectorizado.</p>
<p><strong>Ejercicio 13.1 (¿Qué tan rápido es abs?)</strong> Muchas funciones de R preexistentes ya están vectorizadas y se han optimizado para funcionar rápidamente. Puede hacer que su código sea más rápido confiando en estas funciones siempre que sea posible. Por ejemplo, R viene con una función de valor absoluto incorporada, <code>abs</code>.</p>
<p>Comprueba cuánto más rápido <code>abs</code> calcula el valor absoluto de <code>long</code> que <code>abs_bucle</code> y <code>abs_set</code>.</p>
<div class="solution">
<p><span id="unlabeled-div-32" class="solution"><em>Solution</em>. </span>Puedes medir la velocidad de <code>abs</code> con <code>system.time</code>. A <code>abs</code> le toma 0,05 segundos, a la velocidad del rayo, calcular el valor absoluto de 10 millones de números. Esto es 0,592 / 0,054 = 10,96 veces más rápido que <code>abs_set</code> y casi 300 veces más rápido que <code>abs_bucle</code>:</p>
</div>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="speed.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">abs</span>(largo))</span>
<span id="cb384-2"><a href="speed.html#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="do">##   user  system elapsed </span></span>
<span id="cb384-3"><a href="speed.html#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.037   0.018   0.054</span></span></code></pre></div>
</div>
<div id="cómo-escribir-código-vectorizado" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Cómo Escribir Código Vectorizado<a href="speed.html#cómo-escribir-código-vectorizado" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El código vectorizado es fácil de escribir en R porque la mayoría de las funciones de R ya están vectorizadas. El código basado en estas funciones se puede vectorizar fácilmente y, por lo tanto, es rápido. Para crear código vectorizado:</p>
<ol style="list-style-type: decimal">
<li>Use funciones vectorizadas para completar los pasos secuenciales en su programa.</li>
<li>Use subconjuntos lógicos para manejar casos paralelos. Trate de manipular todos los elementos en un caso a la vez.</li>
</ol>
<p><code>abs_bucle</code> y <code>abs_set</code> ilustran estas reglas. Las funciones manejan dos casos y realizan un paso secuencial, Figure <a href="speed.html#fig:abs">13.1</a>. Si un número es positivo, las funciones lo dejan solo. Si un número es negativo, las funciones lo multiplican por uno negativo.</p>
<div class="figure"><span style="display:block;" id="fig:abs"></span>
<img src="images/hopr_1001.png" alt="abs_loop usa un bucle for para clasificar los datos en uno de dos casos: números negativos y números no negativos." width="649" />
<p class="caption">
Figure 13.1: abs_loop usa un bucle for para clasificar los datos en uno de dos casos: números negativos y números no negativos.
</p>
</div>
<p>Puede identificar todos los elementos de un vector que caen en un caso con una prueba lógica. R ejecutará la prueba en forma de elementos y devolverá un <code>TRUE</code> para cada elemento que pertenezca al caso. Por ejemplo, <code>vec &lt; 0</code> identifica cada valor de <code>vec</code> que pertenece al caso negativo. Puede usar la misma prueba lógica para extraer el conjunto de valores negativos con subconjunto lógico:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="speed.html#cb385-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="dv">7</span>, <span class="sc">-</span><span class="dv">8</span>, <span class="dv">9</span>, <span class="sc">-</span><span class="dv">10</span>)</span>
<span id="cb385-2"><a href="speed.html#cb385-2" aria-hidden="true" tabindex="-1"></a>vec <span class="sc">&lt;</span> <span class="dv">0</span></span>
<span id="cb385-3"><a href="speed.html#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="do">## FALSE TRUE FALSE TRUE FALSE TRUE FALSE TRUE FALSE TRUE</span></span>
<span id="cb385-4"><a href="speed.html#cb385-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-5"><a href="speed.html#cb385-5" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">&lt;</span> <span class="dv">0</span>]</span>
<span id="cb385-6"><a href="speed.html#cb385-6" aria-hidden="true" tabindex="-1"></a><span class="do">## -2  -4  -6  -8 -10</span></span></code></pre></div>
<p>El plan de la Figura <a href="speed.html#fig:abs">13.1</a> ahora requiere un paso secuencial: debe multiplicar cada uno de los valores negativos por uno negativo. Todos los operadores aritméticos de R están vectorizados, por lo que puede usar <code>*</code> para completar este paso de forma vectorizada. <code>*</code> multiplicará cada número en <code>vec[vec &lt; 0]</code> por uno negativo al mismo tiempo:</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="speed.html#cb386-1" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb386-2"><a href="speed.html#cb386-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  4  6  8 10</span></span></code></pre></div>
<p>Finalmente, puede usar el operador de asignación de R, que también está vectorizado, para guardar el nuevo conjunto sobre el antiguo en el objeto <code>vec</code> original. Dado que <code>&lt;-</code> está vectorizado, los elementos del nuevo conjunto se emparejarán con los elementos del antiguo conjunto, en orden, y luego se realizará la asignación por elementos. Como resultado, cada valor negativo será reemplazado por su pareja positiva, como en la figura <a href="speed.html#fig:assignment">13.2</a>.</p>
<div class="figure"><span style="display:block;" id="fig:assignment"></span>
<img src="images/hopr_1002.png" alt="Use subconjuntos lógicos para modificar grupos de valores en su lugar. Los operadores aritméticos y de asignación de R están vectorizados, lo que le permite manipular y actualizar varios valores a la vez." width="782" />
<p class="caption">
Figure 13.2: Use subconjuntos lógicos para modificar grupos de valores en su lugar. Los operadores aritméticos y de asignación de R están vectorizados, lo que le permite manipular y actualizar varios valores a la vez.
</p>
</div>
<p><strong>Ejercicio 13.2 (Vectorizar una función)</strong> La siguiente función convierte un vector de símbolos de tragamonedas en un vector de nuevos símbolos de tragamonedas. ¿Puedes vectorizarlo? ¿Cuánto más rápido funciona la versión vectorizada?</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="speed.html#cb387-1" aria-hidden="true" tabindex="-1"></a>cambiar_simbolos <span class="ot">&lt;-</span> <span class="cf">function</span>(vec){</span>
<span id="cb387-2"><a href="speed.html#cb387-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(vec)){</span>
<span id="cb387-3"><a href="speed.html#cb387-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (vec[i] <span class="sc">==</span> <span class="st">&quot;DD&quot;</span>) {</span>
<span id="cb387-4"><a href="speed.html#cb387-4" aria-hidden="true" tabindex="-1"></a>      vec[i] <span class="ot">&lt;-</span> <span class="st">&quot;comodín&quot;</span></span>
<span id="cb387-5"><a href="speed.html#cb387-5" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (vec[i] <span class="sc">==</span> <span class="st">&quot;C&quot;</span>) {</span>
<span id="cb387-6"><a href="speed.html#cb387-6" aria-hidden="true" tabindex="-1"></a>      vec[i] <span class="ot">&lt;-</span> <span class="st">&quot;as&quot;</span></span>
<span id="cb387-7"><a href="speed.html#cb387-7" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (vec[i] <span class="sc">==</span> <span class="st">&quot;7&quot;</span>) {</span>
<span id="cb387-8"><a href="speed.html#cb387-8" aria-hidden="true" tabindex="-1"></a>      vec[i] <span class="ot">&lt;-</span> <span class="st">&quot;rey&quot;</span></span>
<span id="cb387-9"><a href="speed.html#cb387-9" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span> <span class="cf">if</span> (vec[i] <span class="sc">==</span> <span class="st">&quot;B&quot;</span>) {</span>
<span id="cb387-10"><a href="speed.html#cb387-10" aria-hidden="true" tabindex="-1"></a>      vec[i] <span class="ot">&lt;-</span> <span class="st">&quot;reina&quot;</span></span>
<span id="cb387-11"><a href="speed.html#cb387-11" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (vec[i] <span class="sc">==</span> <span class="st">&quot;BB&quot;</span>) {</span>
<span id="cb387-12"><a href="speed.html#cb387-12" aria-hidden="true" tabindex="-1"></a>      vec[i] <span class="ot">&lt;-</span> <span class="st">&quot;jota&quot;</span></span>
<span id="cb387-13"><a href="speed.html#cb387-13" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (vec[i] <span class="sc">==</span> <span class="st">&quot;BBB&quot;</span>) {</span>
<span id="cb387-14"><a href="speed.html#cb387-14" aria-hidden="true" tabindex="-1"></a>      vec[i] <span class="ot">&lt;-</span> <span class="st">&quot;diez&quot;</span></span>
<span id="cb387-15"><a href="speed.html#cb387-15" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb387-16"><a href="speed.html#cb387-16" aria-hidden="true" tabindex="-1"></a>      vec[i] <span class="ot">&lt;-</span> <span class="st">&quot;nueve&quot;</span></span>
<span id="cb387-17"><a href="speed.html#cb387-17" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb387-18"><a href="speed.html#cb387-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb387-19"><a href="speed.html#cb387-19" aria-hidden="true" tabindex="-1"></a>  vec</span>
<span id="cb387-20"><a href="speed.html#cb387-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb387-21"><a href="speed.html#cb387-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-22"><a href="speed.html#cb387-22" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DD&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;BB&quot;</span>, <span class="st">&quot;BBB&quot;</span>, <span class="st">&quot;0&quot;</span>)</span>
<span id="cb387-23"><a href="speed.html#cb387-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-24"><a href="speed.html#cb387-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cambiar_simbolos</span>(vec)</span>
<span id="cb387-25"><a href="speed.html#cb387-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  &quot;comodín&quot; &quot;as&quot;   &quot;rey&quot;  &quot;reina&quot; &quot;jota&quot;  &quot;diez&quot;   &quot;nueve&quot;</span></span>
<span id="cb387-26"><a href="speed.html#cb387-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-27"><a href="speed.html#cb387-27" aria-hidden="true" tabindex="-1"></a>muchas <span class="ot">&lt;-</span> <span class="fu">rep</span>(vec, <span class="dv">1000000</span>)</span>
<span id="cb387-28"><a href="speed.html#cb387-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-29"><a href="speed.html#cb387-29" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">cambiar_simbolos</span>(muchas))</span>
<span id="cb387-30"><a href="speed.html#cb387-30" aria-hidden="true" tabindex="-1"></a><span class="do">##    user  system elapsed </span></span>
<span id="cb387-31"><a href="speed.html#cb387-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  30.057   0.031  30.079</span></span></code></pre></div>
<div class="solution">
<p><span id="unlabeled-div-33" class="solution"><em>Solution</em>. </span><code>cambiar_simbolos</code> usa un bucle <code>for</code> para clasificar los valores en siete casos diferentes, como se muestra en la Figura <a href="speed.html#fig:change">13.3</a>.</p>
</div>
<p>Para vectorizar <code>cambiar_simbolos</code>, cree una prueba lógica que pueda identificar cada caso:</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="speed.html#cb388-1" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;DD&quot;</span>]</span>
<span id="cb388-2"><a href="speed.html#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;DD&quot;</span></span>
<span id="cb388-3"><a href="speed.html#cb388-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-4"><a href="speed.html#cb388-4" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;C&quot;</span>]</span>
<span id="cb388-5"><a href="speed.html#cb388-5" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;C&quot;</span></span>
<span id="cb388-6"><a href="speed.html#cb388-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-7"><a href="speed.html#cb388-7" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;7&quot;</span>]</span>
<span id="cb388-8"><a href="speed.html#cb388-8" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;7&quot;</span></span>
<span id="cb388-9"><a href="speed.html#cb388-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-10"><a href="speed.html#cb388-10" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;B&quot;</span>]</span>
<span id="cb388-11"><a href="speed.html#cb388-11" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;B&quot;</span></span>
<span id="cb388-12"><a href="speed.html#cb388-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-13"><a href="speed.html#cb388-13" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;BB&quot;</span>]</span>
<span id="cb388-14"><a href="speed.html#cb388-14" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;BB&quot;</span></span>
<span id="cb388-15"><a href="speed.html#cb388-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-16"><a href="speed.html#cb388-16" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;BBB&quot;</span>]</span>
<span id="cb388-17"><a href="speed.html#cb388-17" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;BBB&quot;</span></span>
<span id="cb388-18"><a href="speed.html#cb388-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-19"><a href="speed.html#cb388-19" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;0&quot;</span>]</span>
<span id="cb388-20"><a href="speed.html#cb388-20" aria-hidden="true" tabindex="-1"></a><span class="do">## &quot;0&quot;</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:change"></span>
<img src="images/hopr_1003.png" alt="cambiar_simbolos hace algo diferente para cada uno de los siete casos." width="626" />
<p class="caption">
Figure 13.3: cambiar_simbolos hace algo diferente para cada uno de los siete casos.
</p>
</div>
<p>Luego escribe código que pueda cambiar los símbolos para cada caso:</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="speed.html#cb389-1" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;DD&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;comodín&quot;</span></span>
<span id="cb389-2"><a href="speed.html#cb389-2" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;C&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;as&quot;</span></span>
<span id="cb389-3"><a href="speed.html#cb389-3" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;7&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;rey&quot;</span></span>
<span id="cb389-4"><a href="speed.html#cb389-4" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;B&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;reina&quot;</span></span>
<span id="cb389-5"><a href="speed.html#cb389-5" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;BB&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;jota&quot;</span></span>
<span id="cb389-6"><a href="speed.html#cb389-6" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;BBB&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;diez&quot;</span></span>
<span id="cb389-7"><a href="speed.html#cb389-7" aria-hidden="true" tabindex="-1"></a>vec[vec <span class="sc">==</span> <span class="st">&quot;0&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;nueve&quot;</span></span></code></pre></div>
<p>Cuando combinas esto en una función, tienes una versión vectorizada de <code>cambiar_simbolos</code> que se ejecuta unas 14 veces más rápido:</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="speed.html#cb390-1" aria-hidden="true" tabindex="-1"></a>cambiar_vec <span class="ot">&lt;-</span> <span class="cf">function</span> (vec) {</span>
<span id="cb390-2"><a href="speed.html#cb390-2" aria-hidden="true" tabindex="-1"></a>  vec[vec <span class="sc">==</span> <span class="st">&quot;DD&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;comodín&quot;</span></span>
<span id="cb390-3"><a href="speed.html#cb390-3" aria-hidden="true" tabindex="-1"></a>  vec[vec <span class="sc">==</span> <span class="st">&quot;C&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;as&quot;</span></span>
<span id="cb390-4"><a href="speed.html#cb390-4" aria-hidden="true" tabindex="-1"></a>  vec[vec <span class="sc">==</span> <span class="st">&quot;7&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;rey&quot;</span></span>
<span id="cb390-5"><a href="speed.html#cb390-5" aria-hidden="true" tabindex="-1"></a>  vec[vec <span class="sc">==</span> <span class="st">&quot;B&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;reina&quot;</span></span>
<span id="cb390-6"><a href="speed.html#cb390-6" aria-hidden="true" tabindex="-1"></a>  vec[vec <span class="sc">==</span> <span class="st">&quot;BB&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;jota&quot;</span></span>
<span id="cb390-7"><a href="speed.html#cb390-7" aria-hidden="true" tabindex="-1"></a>  vec[vec <span class="sc">==</span> <span class="st">&quot;BBB&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;diez&quot;</span></span>
<span id="cb390-8"><a href="speed.html#cb390-8" aria-hidden="true" tabindex="-1"></a>  vec[vec <span class="sc">==</span> <span class="st">&quot;0&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;nueve&quot;</span></span>
<span id="cb390-9"><a href="speed.html#cb390-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb390-10"><a href="speed.html#cb390-10" aria-hidden="true" tabindex="-1"></a>  vec</span>
<span id="cb390-11"><a href="speed.html#cb390-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb390-12"><a href="speed.html#cb390-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-13"><a href="speed.html#cb390-13" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">cambiar_vec</span>(muchas))</span>
<span id="cb390-14"><a href="speed.html#cb390-14" aria-hidden="true" tabindex="-1"></a><span class="do">##   user  system elapsed </span></span>
<span id="cb390-15"><a href="speed.html#cb390-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  1.994   0.059   2.051 </span></span></code></pre></div>
<p>O, mejor aún, use una tabla de búsqueda. Las tablas de búsqueda son un método vectorizado porque se basan en las operaciones de selección vectorizadas de R:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="speed.html#cb391-1" aria-hidden="true" tabindex="-1"></a>cambiar_vec2 <span class="ot">&lt;-</span> <span class="cf">function</span>(vec){</span>
<span id="cb391-2"><a href="speed.html#cb391-2" aria-hidden="true" tabindex="-1"></a>  tb <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DD&quot;</span> <span class="ot">=</span> <span class="st">&quot;comodín&quot;</span>, <span class="st">&quot;C&quot;</span> <span class="ot">=</span> <span class="st">&quot;as&quot;</span>, <span class="st">&quot;7&quot;</span> <span class="ot">=</span> <span class="st">&quot;rey&quot;</span>, <span class="st">&quot;B&quot;</span> <span class="ot">=</span> <span class="st">&quot;reina&quot;</span>,</span>
<span id="cb391-3"><a href="speed.html#cb391-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;BB&quot;</span> <span class="ot">=</span> <span class="st">&quot;jota&quot;</span>, <span class="st">&quot;BBB&quot;</span> <span class="ot">=</span> <span class="st">&quot;diez&quot;</span>, <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;nueve&quot;</span>)</span>
<span id="cb391-4"><a href="speed.html#cb391-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unname</span>(tb[vec])</span>
<span id="cb391-5"><a href="speed.html#cb391-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb391-6"><a href="speed.html#cb391-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-7"><a href="speed.html#cb391-7" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">cambiar_vec2</span>(muchas))</span>
<span id="cb391-8"><a href="speed.html#cb391-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   user  system elapsed </span></span>
<span id="cb391-9"><a href="speed.html#cb391-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.687   0.059   0.746 </span></span></code></pre></div>
<p>Aquí, una tabla de búsqueda es 40 veces más rápida que la función original.</p>
<p><code>abs_bucle</code> y <code>cambiar_simbolos</code> ilustran una característica del código vectorizado: los programadores a menudo escriben código no vectorizado más lento basándose en bucles <code>for</code> innecesarios, como el de <code>change_simbolos</code>. Creo que esto es el resultado de un malentendido general sobre R. Los bucles <code>for</code> no se comportan de la misma manera en R que en otros lenguajes, lo que significa que debe escribir código en R de manera diferente a como lo haría en otros lenguajes.</p>
<p>Cuando escribe en lenguajes como C y Fortran, debe compilar su código antes de que su computadora pueda ejecutarlo. Este paso de compilación optimiza cómo los bucles <code>for</code> en el código usan la memoria de su computadora, lo que hace que los bucles <code>for</code> sean muy rápidos. Como resultado, muchos programadores usan bucles <code>for</code> con frecuencia cuando escriben en C y Fortran.</p>
<p>Sin embargo, cuando escribe en R, no compila su código. Omite este paso, lo que hace que la programación en R sea una experiencia más fácil de usar. Desafortunadamente, esto también significa que no le da a sus bucles el aumento de velocidad que recibirían en C o Fortran. Como resultado, sus bucles se ejecutarán más lentamente que las otras operaciones que hemos estudiado: pruebas lógicas, creación de subconjuntos y ejecución por elementos. Si puede escribir su código con las operaciones más rápidas en lugar de un bucle <code>for</code>, debe hacerlo. Independientemente del idioma en el que escriba, debe intentar utilizar las funciones del idioma que se ejecute más rápido.</p>

<div class="rmdtip">
<p><strong>if y for</strong></p>
Una buena forma de detectar bucles <code>for</code> que podrían vectorizarse es buscar combinaciones de <code>if</code> y <code>for</code>. <code>if</code> solo se puede aplicar a un valor a la vez, lo que significa que a menudo se usa junto con un bucle <code>for</code>. El ciclo <code>for</code> ayuda a aplicar <code>if</code> a un vector completo de valores. Esta combinación generalmente se puede reemplazar con un subconjunto lógico, que hará lo mismo pero se ejecutará mucho más rápido.
</div>
<p>Esto no significa que nunca debas usar bucles <code>for</code> en R. Todavía hay muchos lugares en R donde los bucles <code>for</code> tienen sentido. Los bucles <code>for</code> realizan una tarea básica que no siempre se puede recrear con código vectorizado. Los bucles <code>for</code> también son fáciles de entender y se ejecutan razonablemente rápido en R, siempre que tome algunas precauciones.</p>
</div>
<div id="cómo-escribir-bucles-for-rápidos-en-r" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Cómo Escribir Bucles for Rápidos en R<a href="speed.html#cómo-escribir-bucles-for-rápidos-en-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Puede aumentar drásticamente la velocidad de sus bucles <code>for</code> haciendo dos cosas para optimizar cada bucle. Primero, haz todo lo que puedas fuera del bucle <code>for</code>. Cada línea de código que coloques dentro del bucle <code>for</code> se ejecutará muchas, muchas veces. Si una línea de código solo necesita ejecutarse una vez, colóquela fuera del ciclo para evitar la repetición.</p>
<p>En segundo lugar, asegúrese de que cualquier objeto de almacenamiento que utilice con el ciclo sea lo suficientemente grande como para contener <em>todos</em> los resultados del ciclo. Por ejemplo, ambos bucles a continuación necesitarán almacenar un millón de valores. El primer ciclo almacena sus valores en un objeto llamado <code>salida</code> que comienza con una longitud de <em>un millón</em>:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="speed.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>({</span>
<span id="cb392-2"><a href="speed.html#cb392-2" aria-hidden="true" tabindex="-1"></a>  salida <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">1000000</span>) </span>
<span id="cb392-3"><a href="speed.html#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000000</span>) {</span>
<span id="cb392-4"><a href="speed.html#cb392-4" aria-hidden="true" tabindex="-1"></a>    salida[i] <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb392-5"><a href="speed.html#cb392-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb392-6"><a href="speed.html#cb392-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb392-7"><a href="speed.html#cb392-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   user  system elapsed </span></span>
<span id="cb392-8"><a href="speed.html#cb392-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  1.709   0.015   1.724 </span></span></code></pre></div>
<p>El segundo ciclo almacena sus valores en un objeto llamado <code>salida</code> que comienza con una longitud de <em>uno</em>. R expandirá el objeto a una longitud de un millón mientras ejecuta el bucle. El código de este ciclo es muy similar al código del primer ciclo, pero el ciclo tarda <em>37 minutos</em> más en ejecutarse que el primer ciclo:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="speed.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>({</span>
<span id="cb393-2"><a href="speed.html#cb393-2" aria-hidden="true" tabindex="-1"></a>  salida <span class="ot">&lt;-</span> <span class="cn">NA</span> </span>
<span id="cb393-3"><a href="speed.html#cb393-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000000</span>) {</span>
<span id="cb393-4"><a href="speed.html#cb393-4" aria-hidden="true" tabindex="-1"></a>    salida[i] <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb393-5"><a href="speed.html#cb393-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb393-6"><a href="speed.html#cb393-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb393-7"><a href="speed.html#cb393-7" aria-hidden="true" tabindex="-1"></a><span class="do">##     user   system  elapsed </span></span>
<span id="cb393-8"><a href="speed.html#cb393-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1689.537  560.951 2249.927</span></span></code></pre></div>
<p>Los dos bucles hacen lo mismo, entonces, ¿qué explica la diferencia? En el segundo bucle, R tiene que aumentar la longitud de <code>salida</code> en uno para cada ejecución del bucle. Para hacer esto, R necesita encontrar un nuevo lugar en la memoria de su computadora que pueda contener el objeto más grande. Luego, R debe copiar el vector <code>salida</code> y borrar la versión anterior de <code>salida</code> antes de pasar a la siguiente ejecución del bucle. Al final del ciclo, R ha reescrito <code>salida</code> en la memoria de su computadora un millón de veces.</p>
<p>En el primer caso, el tamaño de <code>salida</code> nunca cambia; R puede definir un objeto <code>salida</code> en la memoria y usarlo para cada ejecución del bucle <code>for</code>.</p>

<div class="rmdtip">
<p>Los autores de R usan lenguajes de bajo nivel como C y Fortran para escribir funciones básicas de R, muchas de las cuales usan bucles <code>for</code>. Estas funciones se compilan y optimizan antes de que se conviertan en parte de R, lo que las hace bastante rápidas.</p>
Cada vez que vea <code>.Primitive</code>, <code>.Internal</code> o <code>.Call</code> escrito en la definición de una función, puede estar seguro de que la función está llamando al código de otro idioma. Obtendrá todas las ventajas de velocidad de ese idioma al usar la función.
</div>
</div>
<div id="código-vectorizado-en-la-práctica" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Código Vectorizado en la Práctica<a href="speed.html#código-vectorizado-en-la-práctica" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para ver cómo el código vectorizado puede ayudarlo como científico de datos, considere nuestro proyecto de máquina tragamonedas. En <a href="loops.html#loops">Bucles</a>, calculó la tasa de pago exacta para su máquina tragamonedas, pero podría haber estimado esta tasa de pago con una simulación. Si jugaste a la máquina tragamonedas muchas, muchas veces, el premio promedio de todas las jugadas sería una buena estimación de la verdadera tasa de pago.</p>
<p>Este método de estimación se basa en la ley de los grandes números y es similar a muchas simulaciones estadísticas. Para ejecutar esta simulación, podría usar un bucle <code>for</code>:</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="speed.html#cb394-1" aria-hidden="true" tabindex="-1"></a>ganadas <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="dv">1000000</span>)</span>
<span id="cb394-2"><a href="speed.html#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000000</span>) {</span>
<span id="cb394-3"><a href="speed.html#cb394-3" aria-hidden="true" tabindex="-1"></a>  ganadas[i] <span class="ot">&lt;-</span> <span class="fu">play</span>()</span>
<span id="cb394-4"><a href="speed.html#cb394-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb394-5"><a href="speed.html#cb394-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-6"><a href="speed.html#cb394-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(ganadas)</span>
<span id="cb394-7"><a href="speed.html#cb394-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.9366984</span></span></code></pre></div>
<p>La tasa de pago estimada después de 10 millones de ejecuciones es 0,937, que está muy cerca de la tasa de pago real de 0,934. Tenga en cuenta que estoy usando la función <code>puntuacion</code> modificada que trata a los diamantes como comodines.</p>
<p>Si ejecuta esta simulación, notará que tarda un tiempo en ejecutarse. De hecho, la simulación tarda 342.308 segundos en ejecutarse, lo que equivale a unos 5,7 minutos. Esto no es particularmente impresionante, y puede hacerlo mejor usando código vectorizado:</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="speed.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000000</span>) {</span>
<span id="cb395-2"><a href="speed.html#cb395-2" aria-hidden="true" tabindex="-1"></a>  ganadas[i] <span class="ot">&lt;-</span> <span class="fu">play</span>()</span>
<span id="cb395-3"><a href="speed.html#cb395-3" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb395-4"><a href="speed.html#cb395-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    user  system elapsed </span></span>
<span id="cb395-5"><a href="speed.html#cb395-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 342.041   0.355 342.308 </span></span></code></pre></div>
<p>La función <code>puntuacion</code> actual no está vectorizada. Toma una sola combinación de tragamonedas y usa un árbol <code>if</code> para asignarle un premio. Esta combinación de un árbol <code>if</code> con un bucle <code>for</code> sugiere que podrías escribir una pieza de código vectorizado que tome <em>muchas</em> combinaciones de ranuras y luego use subconjuntos lógicos para operar en todas ellas a la vez.</p>
<p>Por ejemplo, podría reescribir <code>obt_simbolos</code> para generar <em>n</em> combinaciones de ranuras y devolverlas como una matriz <em>n</em> x 3, como la siguiente. Cada fila de la matriz contendrá una combinación de espacios para ser puntuada:</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="speed.html#cb396-1" aria-hidden="true" tabindex="-1"></a>obt_muchos_simbolos <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb396-2"><a href="speed.html#cb396-2" aria-hidden="true" tabindex="-1"></a>  rueda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DD&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;BBB&quot;</span>, <span class="st">&quot;BB&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;0&quot;</span>)</span>
<span id="cb396-3"><a href="speed.html#cb396-3" aria-hidden="true" tabindex="-1"></a>  vec <span class="ot">&lt;-</span> <span class="fu">sample</span>(rueda, <span class="at">size =</span> <span class="dv">3</span> <span class="sc">*</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb396-4"><a href="speed.html#cb396-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.03</span>, <span class="fl">0.03</span>, <span class="fl">0.06</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.01</span>, <span class="fl">0.52</span>))</span>
<span id="cb396-5"><a href="speed.html#cb396-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(vec, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb396-6"><a href="speed.html#cb396-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb396-7"><a href="speed.html#cb396-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-8"><a href="speed.html#cb396-8" aria-hidden="true" tabindex="-1"></a><span class="fu">obt_muchos_simbolos</span>(<span class="dv">5</span>)</span>
<span id="cb396-9"><a href="speed.html#cb396-9" aria-hidden="true" tabindex="-1"></a><span class="do">##      [,1]  [,2] [,3] </span></span>
<span id="cb396-10"><a href="speed.html#cb396-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,] &quot;B&quot;   &quot;0&quot;  &quot;B&quot;  </span></span>
<span id="cb396-11"><a href="speed.html#cb396-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,] &quot;0&quot;   &quot;BB&quot; &quot;7&quot;  </span></span>
<span id="cb396-12"><a href="speed.html#cb396-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,] &quot;0&quot;   &quot;0&quot;  &quot;BBB&quot;</span></span>
<span id="cb396-13"><a href="speed.html#cb396-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,] &quot;0&quot;   &quot;0&quot;  &quot;B&quot;  </span></span>
<span id="cb396-14"><a href="speed.html#cb396-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [5,] &quot;BBB&quot; &quot;0&quot;  &quot;0&quot; </span></span></code></pre></div>
<p>También podría reescribir <code>play</code> para tomar un parámetro, <code>n</code>, y devolver <code>n</code> premios, en un data frame:</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="speed.html#cb397-1" aria-hidden="true" tabindex="-1"></a>play_muchas <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb397-2"><a href="speed.html#cb397-2" aria-hidden="true" tabindex="-1"></a>  simb_mat <span class="ot">&lt;-</span> <span class="fu">obt_muchos_simbolos</span>(<span class="at">n =</span> n)</span>
<span id="cb397-3"><a href="speed.html#cb397-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">w1 =</span> simb_mat[,<span class="dv">1</span>], <span class="at">w2 =</span> simb_mat[,<span class="dv">2</span>],</span>
<span id="cb397-4"><a href="speed.html#cb397-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">w3 =</span> simb_mat[,<span class="dv">3</span>], <span class="at">prize =</span> <span class="fu">puntuacion_muchas</span>(simb_mat))</span>
<span id="cb397-5"><a href="speed.html#cb397-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Esta nueva función facilitaría la simulación de un millón, o incluso 10 millones de jugadas de la máquina tragamonedas, que será nuestro objetivo. Cuando hayamos terminado, podrá estimar la tasa de pago con:</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="speed.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="co"># jugadas &lt;- play_muchas(10000000))</span></span>
<span id="cb398-2"><a href="speed.html#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(jugadas$premio)</span></span></code></pre></div>
<p>Ahora solo necesitas escribir <code>puntuacion_muchas</code>, una versión vectorizada (¿matrixada?) de <code>puntuacion</code> que toma una matriz <em>n</em> x 3 y devuelve <em>n</em> premios. Será difícil escribir esta función porque <code>puntuacion</code> ya es bastante complicado. No espero que se sienta seguro haciendo esto por su cuenta hasta que tenga más práctica y experiencia de la que hemos podido desarrollar aquí.</p>
<p>Si desea probar sus habilidades y escribir una versión de <code>puntuacio_muchas</code>, le recomiendo que use la función <code>rowSums</code> dentro de su código. Calcula la suma de cada fila de números (o lógicos) en una matriz.</p>
<p>Si desea probarse a sí mismo de una manera más modesta, le recomiendo que estudie el siguiente modelo de función <code>puntuacion_muchas</code> hasta que comprenda cómo funciona cada parte y cómo las partes trabajan juntas para crear una función vectorizada. Para hacer esto, será útil crear un ejemplo concreto, como este:</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="speed.html#cb399-1" aria-hidden="true" tabindex="-1"></a>simbolos <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb399-2"><a href="speed.html#cb399-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;DD&quot;</span>, <span class="st">&quot;DD&quot;</span>, <span class="st">&quot;DD&quot;</span>, </span>
<span id="cb399-3"><a href="speed.html#cb399-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;C&quot;</span>, <span class="st">&quot;DD&quot;</span>, <span class="st">&quot;0&quot;</span>, </span>
<span id="cb399-4"><a href="speed.html#cb399-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, </span>
<span id="cb399-5"><a href="speed.html#cb399-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;B&quot;</span>, <span class="st">&quot;BB&quot;</span>, <span class="st">&quot;BBB&quot;</span>, </span>
<span id="cb399-6"><a href="speed.html#cb399-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;0&quot;</span>, </span>
<span id="cb399-7"><a href="speed.html#cb399-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;7&quot;</span>, <span class="st">&quot;DD&quot;</span>, <span class="st">&quot;DD&quot;</span>), <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb399-8"><a href="speed.html#cb399-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-9"><a href="speed.html#cb399-9" aria-hidden="true" tabindex="-1"></a>simbolos</span>
<span id="cb399-10"><a href="speed.html#cb399-10" aria-hidden="true" tabindex="-1"></a><span class="do">##      [,1] [,2] [,3] </span></span>
<span id="cb399-11"><a href="speed.html#cb399-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,] &quot;DD&quot; &quot;DD&quot; &quot;DD&quot; </span></span>
<span id="cb399-12"><a href="speed.html#cb399-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,] &quot;C&quot;  &quot;DD&quot; &quot;0&quot;  </span></span>
<span id="cb399-13"><a href="speed.html#cb399-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,] &quot;B&quot;  &quot;B&quot;  &quot;B&quot;  </span></span>
<span id="cb399-14"><a href="speed.html#cb399-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [4,] &quot;B&quot;  &quot;BB&quot; &quot;BBB&quot;</span></span>
<span id="cb399-15"><a href="speed.html#cb399-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [5,] &quot;C&quot;  &quot;C&quot;  &quot;0&quot;  </span></span>
<span id="cb399-16"><a href="speed.html#cb399-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [6,] &quot;7&quot;  &quot;DD&quot; &quot;DD&quot; </span></span></code></pre></div>
<p>Luego puede ejecutar cada línea de <code>puntuacion_muchas</code> contra el ejemplo y examinar los resultados a medida que avanza.</p>
<p><strong>Ejercicio 13.3 (Pon a Prueba tu Comprensión)</strong> Estudie la función del modelo <code>puntuaciio_muchas</code> hasta que esté satisfecho de que entiende cómo funciona y podría escribir una función similar usted mismo.</p>
<p><strong>Ejercicio 13.4 (Desafío Avanzado)</strong> En lugar de examinar la respuesta modelo, escriba su propia versión vectorizada de <code>puntuacion</code>. Suponga que los datos se almacenan en un <em>n</em> × 3 matriz donde cada fila de la matriz contiene una combinación de ranuras para puntuar.</p>
<p>Puede usar la versión de <code>puntuacion</code> que trata a los diamantes como comodines o la versión de <code>puntuacion</code> que no lo hace. Sin embargo, la respuesta de ejemplo usará la versión que trata a los diamantes como comodines.</p>
<div class="solution">
<p><span id="unlabeled-div-34" class="solution"><em>Solution</em>. </span><code>puntuacion_muchas</code> es una versión vectorizada de <code>puntuacion</code>. Puede usarlo para ejecutar la simulación al comienzo de esta sección en poco más de 20 segundos. Esto es 17 veces más rápido que usar un bucle <code>for</code>:</p>
</div>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="speed.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># los símbolos deben ser una matriz con una columna para cada ventana de la máquina tragamonedas</span></span>
<span id="cb400-2"><a href="speed.html#cb400-2" aria-hidden="true" tabindex="-1"></a>puntuacion_muchas <span class="ot">&lt;-</span> <span class="cf">function</span>(simbolos) {</span>
<span id="cb400-3"><a href="speed.html#cb400-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-4"><a href="speed.html#cb400-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Paso 1: Asigne el premio base basado en cerezas y diamantes ---------</span></span>
<span id="cb400-5"><a href="speed.html#cb400-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Cuente el número de cerezas y diamantes en cada combinación.</span></span>
<span id="cb400-6"><a href="speed.html#cb400-6" aria-hidden="true" tabindex="-1"></a>  cerezas <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(simbolos <span class="sc">==</span> <span class="st">&quot;C&quot;</span>)</span>
<span id="cb400-7"><a href="speed.html#cb400-7" aria-hidden="true" tabindex="-1"></a>  diamantes <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(simbolos <span class="sc">==</span> <span class="st">&quot;DD&quot;</span>) </span>
<span id="cb400-8"><a href="speed.html#cb400-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb400-9"><a href="speed.html#cb400-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Los diamantes salvajes cuentan como cerezas</span></span>
<span id="cb400-10"><a href="speed.html#cb400-10" aria-hidden="true" tabindex="-1"></a>  premio <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">5</span>)[cerezas <span class="sc">+</span> diamantes <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb400-11"><a href="speed.html#cb400-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb400-12"><a href="speed.html#cb400-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## ...pero no si hay cero cerezas reales </span></span>
<span id="cb400-13"><a href="speed.html#cb400-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">### (cerezas es forzado a FALSE donde cerezas == 0)</span></span>
<span id="cb400-14"><a href="speed.html#cb400-14" aria-hidden="true" tabindex="-1"></a>  premio[<span class="sc">!</span>cerezas] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb400-15"><a href="speed.html#cb400-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb400-16"><a href="speed.html#cb400-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Paso 2: Cambie el premio por combinaciones que contengan tríos </span></span>
<span id="cb400-17"><a href="speed.html#cb400-17" aria-hidden="true" tabindex="-1"></a>  iguales <span class="ot">&lt;-</span> simbolos[, <span class="dv">1</span>] <span class="sc">==</span> simbolos[, <span class="dv">2</span>] <span class="sc">&amp;</span> </span>
<span id="cb400-18"><a href="speed.html#cb400-18" aria-hidden="true" tabindex="-1"></a>    simbolos[, <span class="dv">2</span>] <span class="sc">==</span> simbolos[, <span class="dv">3</span>]</span>
<span id="cb400-19"><a href="speed.html#cb400-19" aria-hidden="true" tabindex="-1"></a>  pagos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DD&quot;</span> <span class="ot">=</span> <span class="dv">100</span>, <span class="st">&quot;7&quot;</span> <span class="ot">=</span> <span class="dv">80</span>, <span class="st">&quot;BBB&quot;</span> <span class="ot">=</span> <span class="dv">40</span>, </span>
<span id="cb400-20"><a href="speed.html#cb400-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;BB&quot;</span> <span class="ot">=</span> <span class="dv">25</span>, <span class="st">&quot;B&quot;</span> <span class="ot">=</span> <span class="dv">10</span>, <span class="st">&quot;C&quot;</span> <span class="ot">=</span> <span class="dv">10</span>, <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="dv">0</span>)</span>
<span id="cb400-21"><a href="speed.html#cb400-21" aria-hidden="true" tabindex="-1"></a>  premio[iguales] <span class="ot">&lt;-</span> pagos[simbolos[iguales, <span class="dv">1</span>]]</span>
<span id="cb400-22"><a href="speed.html#cb400-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb400-23"><a href="speed.html#cb400-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Paso 3: Cambia el premio por combinaciones que contengan todas barras ------</span></span>
<span id="cb400-24"><a href="speed.html#cb400-24" aria-hidden="true" tabindex="-1"></a>  barras <span class="ot">&lt;-</span> simbolos <span class="sc">==</span> <span class="st">&quot;B&quot;</span> <span class="sc">|</span> simbolos <span class="sc">==</span>  <span class="st">&quot;BB&quot;</span> <span class="sc">|</span> simbolos <span class="sc">==</span> <span class="st">&quot;BBB&quot;</span></span>
<span id="cb400-25"><a href="speed.html#cb400-25" aria-hidden="true" tabindex="-1"></a>  todas_barras <span class="ot">&lt;-</span> barras[, <span class="dv">1</span>] <span class="sc">&amp;</span> barras[, <span class="dv">2</span>] <span class="sc">&amp;</span> barras[, <span class="dv">3</span>] <span class="sc">&amp;</span> <span class="sc">!</span>iguales</span>
<span id="cb400-26"><a href="speed.html#cb400-26" aria-hidden="true" tabindex="-1"></a>  premio[todas_barras] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb400-27"><a href="speed.html#cb400-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb400-28"><a href="speed.html#cb400-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Paso 4: Manejar comodines ---------------------------------------------</span></span>
<span id="cb400-29"><a href="speed.html#cb400-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb400-30"><a href="speed.html#cb400-30" aria-hidden="true" tabindex="-1"></a>  <span class="do">## combos con dos diamantes</span></span>
<span id="cb400-31"><a href="speed.html#cb400-31" aria-hidden="true" tabindex="-1"></a>  dos_salvajes <span class="ot">&lt;-</span> diamantes <span class="sc">==</span> <span class="dv">2</span></span>
<span id="cb400-32"><a href="speed.html#cb400-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-33"><a href="speed.html#cb400-33" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Identificar el simbolo no salvaje</span></span>
<span id="cb400-34"><a href="speed.html#cb400-34" aria-hidden="true" tabindex="-1"></a>  uno <span class="ot">&lt;-</span> dos_salvajes <span class="sc">&amp;</span> simbolos[, <span class="dv">1</span>] <span class="sc">!=</span> simbolos[, <span class="dv">2</span>] <span class="sc">&amp;</span> </span>
<span id="cb400-35"><a href="speed.html#cb400-35" aria-hidden="true" tabindex="-1"></a>    simbolos[, <span class="dv">2</span>] <span class="sc">==</span> simbolos[, <span class="dv">3</span>]</span>
<span id="cb400-36"><a href="speed.html#cb400-36" aria-hidden="true" tabindex="-1"></a>  dos <span class="ot">&lt;-</span> dos_salvajes <span class="sc">&amp;</span> simbolos[, <span class="dv">1</span>] <span class="sc">!=</span> simbolos[, <span class="dv">2</span>] <span class="sc">&amp;</span> </span>
<span id="cb400-37"><a href="speed.html#cb400-37" aria-hidden="true" tabindex="-1"></a>    simbolos[, <span class="dv">1</span>] <span class="sc">==</span> simbolos[, <span class="dv">3</span>]</span>
<span id="cb400-38"><a href="speed.html#cb400-38" aria-hidden="true" tabindex="-1"></a>  tres <span class="ot">&lt;-</span> dos_salvajes <span class="sc">&amp;</span> simbolos[, <span class="dv">1</span>] <span class="sc">==</span> simbolos[, <span class="dv">2</span>] <span class="sc">&amp;</span> </span>
<span id="cb400-39"><a href="speed.html#cb400-39" aria-hidden="true" tabindex="-1"></a>    simbolos[, <span class="dv">2</span>] <span class="sc">!=</span> simbolos[, <span class="dv">3</span>]</span>
<span id="cb400-40"><a href="speed.html#cb400-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb400-41"><a href="speed.html#cb400-41" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Tratar como tres de una clase</span></span>
<span id="cb400-42"><a href="speed.html#cb400-42" aria-hidden="true" tabindex="-1"></a>  premio[uno] <span class="ot">&lt;-</span> pagos[simbolos[uno, <span class="dv">1</span>]]</span>
<span id="cb400-43"><a href="speed.html#cb400-43" aria-hidden="true" tabindex="-1"></a>  premio[dos] <span class="ot">&lt;-</span> pagos[simbolos[dos, <span class="dv">2</span>]]</span>
<span id="cb400-44"><a href="speed.html#cb400-44" aria-hidden="true" tabindex="-1"></a>  premio[tres] <span class="ot">&lt;-</span> pagos[simbolos[tres, <span class="dv">3</span>]]</span>
<span id="cb400-45"><a href="speed.html#cb400-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb400-46"><a href="speed.html#cb400-46" aria-hidden="true" tabindex="-1"></a>  <span class="do">## combos con un salvaje</span></span>
<span id="cb400-47"><a href="speed.html#cb400-47" aria-hidden="true" tabindex="-1"></a>  un_salvaje <span class="ot">&lt;-</span> diamantes <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb400-48"><a href="speed.html#cb400-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb400-49"><a href="speed.html#cb400-49" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Tratar como todas las barras (si corresponde)</span></span>
<span id="cb400-50"><a href="speed.html#cb400-50" aria-hidden="true" tabindex="-1"></a>  barras_salvajes <span class="ot">&lt;-</span> un_salvaje <span class="sc">&amp;</span> (<span class="fu">rowSums</span>(barras) <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb400-51"><a href="speed.html#cb400-51" aria-hidden="true" tabindex="-1"></a>  premio[barras_salvajes] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb400-52"><a href="speed.html#cb400-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb400-53"><a href="speed.html#cb400-53" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Tratar como tres de una clase (si corresponde)</span></span>
<span id="cb400-54"><a href="speed.html#cb400-54" aria-hidden="true" tabindex="-1"></a>  uno <span class="ot">&lt;-</span> un_salvaje <span class="sc">&amp;</span> simbolos[, <span class="dv">1</span>] <span class="sc">==</span> simbolos[, <span class="dv">2</span>]</span>
<span id="cb400-55"><a href="speed.html#cb400-55" aria-hidden="true" tabindex="-1"></a>  dos <span class="ot">&lt;-</span> un_salvaje <span class="sc">&amp;</span> simbolos[, <span class="dv">2</span>] <span class="sc">==</span> simbolos[, <span class="dv">3</span>]</span>
<span id="cb400-56"><a href="speed.html#cb400-56" aria-hidden="true" tabindex="-1"></a>  tres <span class="ot">&lt;-</span> un_salvaje <span class="sc">&amp;</span> simbolos[, <span class="dv">3</span>] <span class="sc">==</span> simbolos[, <span class="dv">1</span>]</span>
<span id="cb400-57"><a href="speed.html#cb400-57" aria-hidden="true" tabindex="-1"></a>  premio[uno] <span class="ot">&lt;-</span> pagos[simbolos[uno, <span class="dv">1</span>]]</span>
<span id="cb400-58"><a href="speed.html#cb400-58" aria-hidden="true" tabindex="-1"></a>  premio[dos] <span class="ot">&lt;-</span> pagos[simbolos[dos, <span class="dv">2</span>]]</span>
<span id="cb400-59"><a href="speed.html#cb400-59" aria-hidden="true" tabindex="-1"></a>  premio[tres] <span class="ot">&lt;-</span> pagos[simbolos[tres, <span class="dv">3</span>]]</span>
<span id="cb400-60"><a href="speed.html#cb400-60" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb400-61"><a href="speed.html#cb400-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Paso 5: Premio doble por cada diamante en combo ------------------</span></span>
<span id="cb400-62"><a href="speed.html#cb400-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unname</span>(premio <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>diamantes)</span>
<span id="cb400-63"><a href="speed.html#cb400-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb400-64"><a href="speed.html#cb400-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb400-65"><a href="speed.html#cb400-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-66"><a href="speed.html#cb400-66" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">play_muchas</span>(<span class="dv">10000000</span>))</span>
<span id="cb400-67"><a href="speed.html#cb400-67" aria-hidden="true" tabindex="-1"></a><span class="do">##   user  system elapsed </span></span>
<span id="cb400-68"><a href="speed.html#cb400-68" aria-hidden="true" tabindex="-1"></a><span class="do">## 20.942   1.433  22.367</span></span></code></pre></div>
<div id="bucles-vs-código-vectorizado" class="section level3 hasAnchor" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Bucles vs Código Vectorizado<a href="speed.html#bucles-vs-código-vectorizado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En muchos idiomas, los bucles <code>for</code> se ejecutan muy rápido. Como resultado, los programadores aprenden a usar bucles <code>for</code> siempre que sea posible cuando codifican. A menudo, estos programadores continúan confiando en los bucles <code>for</code> cuando comienzan a programar en R, normalmente sin tomar los pasos necesarios para optimizar los bucles <code>for</code> de R. Estos programadores pueden desilusionarse con R cuando su código no funciona tan rápido como les gustaría. Si cree que esto le puede estar pasando a usted, examine con qué frecuencia está usando bucles <code>for</code> y para qué los está usando. Si te encuentras usando bucles <code>for</code> para cada tarea, es muy probable que estés “hablando R con acento C”. La cura es aprender a escribir y usar código vectorizado.</p>
<p>Esto no significa que los bucles <code>for</code> no tengan cabida en R. Los bucles <code>for</code> son una característica muy útil; pueden hacer muchas cosas que el código vectorizado no puede hacer. Tampoco debe convertirse en esclavo del código vectorizado. A veces llevaría más tiempo reescribir el código en formato vectorizado que dejar que se ejecute un bucle <code>for</code>. Por ejemplo, ¿sería más rápido dejar que la simulación de tragamonedas se ejecute durante 5,7 minutos o volver a escribir <code>puntuacion</code>?</p>
</div>
</div>
<div id="resumen-9" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Resumen<a href="speed.html#resumen-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El código rápido es un componente importante de la ciencia de datos porque puede hacer más con el código rápido que con el código lento. Puede trabajar con conjuntos de datos más grandes antes de que intervengan las restricciones computacionales y puede hacer más cálculos antes de que intervengan las restricciones de tiempo. El código más rápido en R se basará en las cosas que R hace mejor: pruebas lógicas, creación de subconjuntos y ejecución por elementos. He llamado a este tipo de código código vectorizado porque el código escrito con estas operaciones tomará un vector de valores como entrada y operará en cada elemento del vector al mismo tiempo. La mayoría del código escrito en R ya está vectorizado.</p>
<p>Si usa estas operaciones, pero su código no aparece vectorizado, analice los pasos secuenciales y los casos paralelos en su programa. Asegúrese de haber utilizado funciones vectorizadas para manejar los pasos y subconjuntos lógicos para manejar los casos. Tenga en cuenta, sin embargo, que algunas tareas no se pueden vectorizar.</p>
</div>
<div id="resumen-del-proyecto-3" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Resumen del Proyecto 3<a href="speed.html#resumen-del-proyecto-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ahora ha escrito su primer programa en R, y es un programa del que debería estar orgulloso. <code>play</code> no es un simple ejercicio de <code>hola mundo</code>, sino un programa real que realiza una tarea real de una manera complicada.</p>
<p>Escribir nuevos programas en R siempre será un desafío porque la programación depende mucho de su propia creatividad, capacidad de resolución de problemas y experiencia escribiendo tipos de programas similares. Sin embargo, puede usar las sugerencias de este capítulo para hacer que incluso el programa más complicado sea manejable: divida las tareas en pasos y casos simples, trabaje con ejemplos concretos y describa posibles soluciones en español.</p>
<p>Este proyecto completa la educación que comenzaste en <a href="Básico.html#Básico">Lo Más Básico</a>. Ahora puede usar R para manejar datos, lo que ha aumentado su capacidad para analizar datos. Usted puede:</p>
<ul>
<li>Cargue y almacene datos en su computadora, no en papel o en su mente</li>
<li>Recuerda y cambia con precisión valores individuales sin depender de tu memoria</li>
<li>Indique a su computadora que realice tareas tediosas o complejas en su nombre</li>
</ul>
<p>Estas habilidades resuelven un problema logístico importante al que se enfrenta todo científico de datos: <em>¿cómo puede almacenar y manipular datos sin cometer errores?</em> Sin embargo, este no es el único problema al que se enfrentará como científico de datos. El siguiente problema aparecerá cuando intente comprender la información contenida en sus datos. Es casi imposible detectar ideas o descubrir patrones en datos sin procesar. Aparecerá un tercer problema cuando intente usar su conjunto de datos para razonar sobre la realidad, que incluye cosas que no están contenidas en su conjunto de datos. ¿Qué implican exactamente sus datos sobre cosas fuera del conjunto de datos? ¿Qué tan seguro puedes estar?</p>
<p>Me refiero a estos problemas como problemas logísticos, tácticos y estratégicos de la ciencia de datos, como se muestra en la Figura <a href="speed.html#fig:venn">13.4</a>. Los enfrentará cada vez que intente aprender de los datos:</p>
<ul>
<li><strong>Un problema logístico:</strong> - ¿Cómo puedes almacenar y manipular datos sin cometer errores?</li>
<li><strong>Un problema táctico</strong> - ¿Cómo puedes descubrir la información contenida en tus datos?</li>
<li><strong>Un problema estratégico</strong> - ¿Cómo puedes usar los datos para sacar conclusiones sobre el mundo en general?</li>
</ul>
<div class="figure"><span style="display:block;" id="fig:venn"></span>
<img src="images/hopr_1004.png" alt="Los tres conjuntos de habilidades básicas de la ciencia de datos: programación informática, comprensión de datos y razonamiento científico." width="734" />
<p class="caption">
Figure 13.4: Los tres conjuntos de habilidades básicas de la ciencia de datos: programación informática, comprensión de datos y razonamiento científico.
</p>
</div>
<p>Un científico de datos completo deberá poder resolver cada uno de estos problemas en muchas situaciones diferentes. Al aprender a programar en R, domina el problema logístico, que es un requisito previo para resolver los problemas tácticos y estratégicos.</p>
<p>Si desea aprender a razonar con datos, o cómo transformar, visualizar y explorar sus conjuntos de datos con herramientas R, le recomiendo el libro <a href="http://r4ds.had.co.nz/"><em>R for Data Science</em></a>, el volumen complementario de este libro. <em>R for Data Science</em> enseña un flujo de trabajo simple para transformar, visualizar y modelar datos en R, así como también cómo informar los resultados con el paquete R Markdown.</p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="loops.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="starting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/davidrsch/hopres/edit/main/speed.rmd",
"text": "Editar"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
